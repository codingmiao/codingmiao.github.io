<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>mapbox-glæ•™ç¨‹(3):æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼ˆå°æ•°æ®é‡çš„æ–¹å¼ï¼‰(ä¸‹)</title>
    <link href="/2020/12/28/2020-12-28-mapbox-gl-tutorial-3/"/>
    <url>/2020/12/28/2020-12-28-mapbox-gl-tutorial-3/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¤ºä¾‹çš„è¯¦ç»†è¯´æ˜"><a href="#ç¤ºä¾‹çš„è¯¦ç»†è¯´æ˜" class="headerlink" title="ç¤ºä¾‹çš„è¯¦ç»†è¯´æ˜"></a>ç¤ºä¾‹çš„è¯¦ç»†è¯´æ˜</h1><p>æˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸€ä¸‹<a href="/2020/12/25/2020-12-25-mapbox-gl-tutorial-2/">ä¸Šä¸€ç« </a>çš„demoï¼š<br>è¦æƒ³å±•ç¤ºè‡ªå®šä¹‰æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠæ•°æ®åšæˆæ•°æ®æºæ·»åŠ åˆ°mapå¯¹è±¡é‡Œï¼Œç„¶åå†æ–°å»ºä¸€ä¸ªå›¾å±‚æŒ‡å®šæ ·å¼å’Œæ•°æ®æºæ·»åŠ åˆ°mapã€‚<br>æ‰€ä»¥åœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”¨æ„é€ äº†åŒ…å«ä¸¤ä¸ªç‚¹çš„<strong>geojson</strong>æ•°æ®æºï¼Œç„¶åæ„é€ äº†ä¸€ä¸ªåŠå¾„ä¸º20åƒç´ çš„çº¢ç‚¹<strong>æ ·å¼</strong>ï¼Œå°±å®Œæˆäº†æ•°æ®çš„å±•ç°å·¥ä½œã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†äº†è§£ä¸€ä¸‹geojsonå’Œæ ·å¼çš„ç»“æ„</p><h2 id="geojson"><a href="#geojson" class="headerlink" title="geojson"></a>geojson</h2><p><a href="https://tools.ietf.org/html/rfc7946" target="_blank" rel="noopener">è¿™ä¸ªç½‘é¡µ</a>è¯¦ç»†ä»‹ç»äº†geojsonçš„æ ‡å‡†ï¼›<br><a href="https://www.oschina.net/translate/geojson-spec" target="_blank" rel="noopener">è¿™ä¸ªç½‘é¡µ</a>å¯¹geojsonæ ‡å‡†è¿›è¡Œäº†ç¿»è¯‘ã€‚<br>æ€»ä¹‹å¾ˆè¯¦ç»†å¾ˆå¤æ‚å°±æ˜¯äº†ã€‚æˆ‘ä»¬çš„åº”ç”¨ä¸­ä¸€èˆ¬ä¸éœ€è¦è¿™ä¹ˆå¤æ‚ï¼Œæ‰€ä»¥è¿™é‡Œå¯¹mapboxé‡Œgeojsonæ•°æ®æºçš„å¸¸ç”¨å±æ€§è¿›è¡Œè¯´æ˜ï¼š</p><h3 id="è¦ç´ å®¹å™¨-FeatureCollection"><a href="#è¦ç´ å®¹å™¨-FeatureCollection" class="headerlink" title="è¦ç´ å®¹å™¨(FeatureCollection)"></a>è¦ç´ å®¹å™¨(FeatureCollection)</h3><p>mapboxçš„geojsonæ•°æ®æºï¼Œdataéƒ¨åˆ†è¦ä¼ å…¥ä¸€ä¸ªFeatureCollectionï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"FeatureCollection"</span>,<br>    <span class="hljs-attr">"features"</span>: [<br>      ...<span class="hljs-comment">//è¿™é‡Œæ”¾è¦ç´ </span><br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><p>å¾ˆç®€å•ï¼Œå°±æ˜¯ç•™å‡ºä¸€ä¸ªæ•°ç»„æ¥æ”¾è¦ç´ </p><h3 id="è¦ç´ "><a href="#è¦ç´ " class="headerlink" title="è¦ç´ "></a>è¦ç´ </h3><p>è¦ç´ åŒ…å«äº†å½¢çŠ¶(geometry)å’Œå±æ€§(properties)</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Feature"</span>,<br>    <span class="hljs-attr">"geometry"</span>: ...<span class="hljs-comment">//è¿™é‡Œæ”¾å½¢çŠ¶json,</span><br>    <span class="hljs-string">"properties"</span>: ...<span class="hljs-comment">//è¿™é‡Œæ”¾å±æ€§</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å±æ€§å°±æ˜¯ä¸€ä¸ªkey-valueæ ¼å¼çš„json,å¦‚<code>{name:&quot;å¼ ä¸‰&quot;,age:25}</code></p><p>å½¢çŠ¶åˆ™æ ¹æ®å…¶ç±»å‹çš„ä¸åŒæœ‰ä¸åŒçš„æ ¼å¼ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹å¸¸è§çš„ç‚¹ã€çº¿ã€é¢ä¸‰ç§ç±»å‹ï¼š</p><h4 id="ç‚¹å½¢çŠ¶-point"><a href="#ç‚¹å½¢çŠ¶-point" class="headerlink" title="ç‚¹å½¢çŠ¶(point)"></a>ç‚¹å½¢çŠ¶(point)</h4><p>åœ¨coordinateså±æ€§ä¸­æ”¾äº†ä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„å­˜æ”¾ç»çº¬åº¦</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">"type"</span>: <span class="hljs-string">"Point"</span>,<br><span class="hljs-attr">"coordinates"</span>: [<span class="hljs-number">102.0</span>, <span class="hljs-number">0.5</span>]<span class="hljs-comment">//ç»çº¬åº¦</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="çº¿å½¢çŠ¶-LineString"><a href="#çº¿å½¢çŠ¶-LineString" class="headerlink" title="çº¿å½¢çŠ¶(LineString)"></a>çº¿å½¢çŠ¶(LineString)</h4><p>åœ¨coordinateså±æ€§ä¸­æ”¾äº†ä¸€ç»„ç»çº¬åº¦åæ ‡å­˜æ”¾çº¿ä¸Šæ¯ä¸ªç‚¹çš„ç»çº¬åº¦</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">"type"</span>: <span class="hljs-string">"LineString"</span>,<br><span class="hljs-attr">"coordinates"</span>: [<br>[<span class="hljs-number">102.0</span>, <span class="hljs-number">0.0</span>],<br>[<span class="hljs-number">103.0</span>, <span class="hljs-number">1.0</span>],<br>[<span class="hljs-number">104.0</span>, <span class="hljs-number">0.0</span>],<br>[<span class="hljs-number">105.0</span>, <span class="hljs-number">1.0</span>]<br>]<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="é¢å½¢çŠ¶-Polygon"><a href="#é¢å½¢çŠ¶-Polygon" class="headerlink" title="é¢å½¢çŠ¶(Polygon)"></a>é¢å½¢çŠ¶(Polygon)</h4><p>åœ¨coordinateså±æ€§ä¸­æ”¾äº†ä¸€ç»„ç»çº¬åº¦åæ ‡å­˜é¢çº¿ä¸Šæ¯ä¸ªç‚¹çš„ç»çº¬åº¦</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Polygon"</span>,<br>  <span class="hljs-attr">"coordinates"</span>: [<br>    [<br>      [<span class="hljs-number">100.0</span>, <span class="hljs-number">0.0</span>],<br>      [<span class="hljs-number">101.0</span>, <span class="hljs-number">0.0</span>],<br>      [<span class="hljs-number">101.0</span>, <span class="hljs-number">1.0</span>],<br>      [<span class="hljs-number">100.0</span>, <span class="hljs-number">1.0</span>],<br>      [<span class="hljs-number">100.0</span>, <span class="hljs-number">0.0</span>]<br>    ]<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œcoordinateså¿…é¡»å½¢æˆä¸€ä¸ªç¯ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªåæ ‡å¿…é¡»ä¸æœ€åä¸€ä¸ªåæ ‡å¿…é¡»ç›¸åŒï¼›<br>Polygonçš„coordinatesæ¯”LineStringçš„coordinateså¤šäº†ä¸€å±‚æ‹¬å·ï¼Œè¿™æ˜¯å› ä¸ºé¢å¯èƒ½ç”±å¤šä¸ªç¯ç»„æˆï¼Œå¯ä»¥æƒ³è±¡ä¸€ä¸‹é“œé’±ï¼Œå®ƒç”±ä¸€ä¸ªå¤–åœˆçš„åœ†å’Œå†…åœˆçš„æ­£æ–¹å½¢æ„æˆï¼›<br>å¤šä¸ªç¯çš„Polygonè¿˜è¦æ³¨æ„åæ ‡çš„é¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆé¡ºåºï¼Œä¸€ä¸ªç¯çš„è¯å°±éšæ„äº†ã€‚</p><h2 id="å›¾å±‚ä¸æ ·å¼"><a href="#å›¾å±‚ä¸æ ·å¼" class="headerlink" title="å›¾å±‚ä¸æ ·å¼"></a>å›¾å±‚ä¸æ ·å¼</h2><p>mapboxæœ‰å¾ˆå¤šç§ç±»å‹ï¼Œæ¯ç§ç±»å‹çš„å›¾å±‚åˆé…æœ‰å¯¹åº”çš„æ ·å¼å±æ€§ï¼Œä¸€ä¸ªæ ‡å‡†çš„å›¾å±‚jsonæ ¼å¼å¦‚ä¸‹:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"lightLinelayer"</span>,<span class="hljs-comment">//å›¾å±‚id</span><br>  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"line"</span>,<span class="hljs-comment">//å›¾å±‚ç±»å‹</span><br>  <span class="hljs-attr">"source"</span>: <span class="hljs-string">"lightSource"</span>,<span class="hljs-comment">//æ•°æ®æºid</span><br>  <span class="hljs-attr">"layout"</span>: &#123;<span class="hljs-comment">//æ ·å¼çš„å¸ƒå±€å±æ€§</span><br>    <span class="hljs-attr">"line-join"</span>: <span class="hljs-string">"round"</span>,<br>    <span class="hljs-attr">"line-cap"</span>: <span class="hljs-string">"round"</span><br>  &#125;,<br>  <span class="hljs-attr">"paint"</span>: &#123;<span class="hljs-comment">//æ ·å¼çš„ç»˜åˆ¶å±æ€§</span><br>    <span class="hljs-attr">"line-color"</span>: <span class="hljs-string">"#00FFFF"</span>,<br>    <span class="hljs-attr">"line-width"</span>: <span class="hljs-number">5</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ·å¼çš„ä¿¡æ¯æ•£è½åœ¨å¸ƒå±€å±æ€§(layout)å’Œç»˜åˆ¶å±æ€§(paint)ä¸­ï¼Œä»äººç±»çš„æ€ç»´ä¸Šï¼Œlayoutå’Œpaintå¹¶æ²¡æœ‰æ˜æ˜¾çš„åŒºåˆ†ï¼Œä¾‹å¦‚çº¿å®½(line-width)å’Œçº¿ç«¯ç‚¹(line-cap)éƒ½æ˜¯å¯¹çº¿å‹çš„æè¿°ï¼Œä½†å´åˆ†åˆ«è½åœ¨äº†paintå’Œlayoutä¸­ï¼Œ<br>æ‰€ä»¥ï¼Œå…·ä½“æ¯ç§å›¾å±‚æœ‰å“ªäº›æ ·å¼å±æ€§ï¼Œæ˜¯layoutè¿˜æ˜¯paintï¼Œéœ€è¦æŸ¥é˜…<a href="https://www.mapbox.cn/mapbox-gl-js/style-spec/#layers" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><h2 id="æ•°æ®å’Œæ ·å¼çš„ä¿®æ”¹"><a href="#æ•°æ®å’Œæ ·å¼çš„ä¿®æ”¹" class="headerlink" title="æ•°æ®å’Œæ ·å¼çš„ä¿®æ”¹"></a>æ•°æ®å’Œæ ·å¼çš„ä¿®æ”¹</h2><p>ä¸‹é¢å¯¹ä¾‹å­ä½œä¸€ä¸‹æ‰©å……ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•æ”¹å˜æ ·å¼å’Œæ•°æ®</p><h3 id="ä¿®æ”¹æ ·å¼"><a href="#ä¿®æ”¹æ ·å¼" class="headerlink" title="ä¿®æ”¹æ ·å¼"></a>ä¿®æ”¹æ ·å¼</h3><p><code>map.setLayoutProperty</code>å’Œ<code>map.setPaintProperty</code>å‡½æ•°å¯ä»¥è®¾ç½®å›¾å±‚çš„å¸ƒå±€å±æ€§å’Œç»˜åˆ¶å±æ€§ï¼Œè¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†æŠŠç‚¹çš„é¢œè‰²æ¥å›åˆ‡æ¢ï¼š</p><div>    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'></script>    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css' rel='stylesheet'/>    <div id='map' style='width: 90%; height: 300px;'></div>    <script>        mapboxgl.accessToken = 'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA';        const map = new mapboxgl.Map({            container: 'map',            style: 'mapbox://styles/mapbox/streets-v9',            center: [116.405419, 39.923568],            zoom: 11        });        map.on('load', function () {            const mySource = {                "type": "geojson",                "data": {                    "type": "FeatureCollection",                    "features": [                        {                            "type": "Feature",                            "geometry": {                                "type": "Point",                                "coordinates": [116.338728, 39.913385]                            },                            "properties": {                                "name": "ç‚¹1",                            }                        },                        {                            "type": "Feature",                            "geometry": {                                "type": "Point",                                "coordinates": [116.405419, 39.923568]                            },                            "properties": {                                "name": "ç‚¹1",                                "type": "æµ‹è¯•ç±»å‹"                            }                        }                    ]                }            };            map.addSource('source1', mySource);            let currentColor = "#FF0000";            map.addLayer({                "id": "testLayer",                "source": 'source1',                "type": "circle",                "paint": {                    "circle-color": currentColor,                    "circle-radius": 20                }            });            setInterval(function (){                if("#FF0000"==currentColor){                    currentColor = "#0000FF"                }else {                    currentColor = "#FF0000"                }                map.setPaintProperty('testLayer',"circle-color",currentColor)            },1000)        });    </script></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> currentColor = <span class="hljs-string">"#FF0000"</span><br>map.addLayer(&#123;<br>    <span class="hljs-string">"id"</span>: <span class="hljs-string">"testLayer"</span>,<br>    <span class="hljs-string">"source"</span>: <span class="hljs-string">'source1'</span>,<br>    <span class="hljs-string">"type"</span>: <span class="hljs-string">"circle"</span>,<br>    <span class="hljs-string">"paint"</span>: &#123;<br>        <span class="hljs-string">"circle-color"</span>: currentColor,<br>        <span class="hljs-string">"circle-radius"</span>: <span class="hljs-number">20</span><br>    &#125;<br>&#125;);<br><span class="hljs-comment">//å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨å®šæœŸä¿®æ”¹é¢œè‰²</span><br>setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-string">"#FF0000"</span>==currentColor)&#123;<br>        currentColor = <span class="hljs-string">"#0000FF"</span><br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        currentColor = <span class="hljs-string">"#FF0000"</span><br>    &#125;<br>    <span class="hljs-comment">//ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å›¾å±‚idã€å±æ€§åã€å±æ€§å€¼</span><br>    map.setPaintProperty(<span class="hljs-string">'testLayer'</span>,<span class="hljs-string">"circle-color"</span>,currentColor)<br>&#125;,<span class="hljs-number">1000</span>)<br></code></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ•°æ®"><a href="#ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¿®æ”¹æ•°æ®"></a>ä¿®æ”¹æ•°æ®</h3><p><code>map.getSource(&#39;sourceId&#39;).setData</code>å‡½æ•°å¯ä»¥ä¿®æ”¹æ•°æ®æºå†…å®¹ï¼Œè¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†ä¿®æ”¹åæ ‡ä¿¡æ¯ä½¿çº¢ç‚¹æ°´å¹³ç§»åŠ¨ï¼š</p><div>    <div id='map1' style='width: 90%; height: 300px;'></div>    <script>        const map1 = new mapboxgl.Map({            container: 'map1',            style: 'mapbox://styles/mapbox/streets-v9',            center: [116.405419, 39.923568],            zoom: 11        });        map1.on('load', function () {            const mySource = {                "type": "geojson",                "data": {                    "type": "FeatureCollection",                    "features": [                        {                            "type": "Feature",                            "geometry": {                                "type": "Point",                                "coordinates": [116.338728, 39.913385]                            },                            "properties": {                                "name": "ç‚¹1",                            }                        }                    ]                }            };            map1.addSource('source1', mySource);            map1.addLayer({                "id": "testLayer",                "source": 'source1',                "type": "circle",                "paint": {                    "circle-color": "#FF0000",                    "circle-radius": 20                }            });            const xmin = 116.338728, xmax = 116.405419, step = 0.0001;            const source1 = map1.getSource('source1');            let currentX = xmin;            //å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨å®šæœŸä¿®æ”¹é¢œè‰²            setInterval(function () {                currentX += step                if (currentX > xmax) {                    currentX = xmin;                }                source1.setData(                    {                        "type": "FeatureCollection",                        "features": [                            {                                "type": "Feature",                                "geometry": {                                    "type": "Point",                                    "coordinates": [currentX, 39.913385]                                },                                "properties": {                                    "name": "ç‚¹1",                                }                            }                        ]                    }                );            }, 10)        });    </script></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mySource = &#123;<br>    <span class="hljs-string">"type"</span>: <span class="hljs-string">"geojson"</span>,<br>    <span class="hljs-string">"data"</span>: &#123;<br>        <span class="hljs-string">"type"</span>: <span class="hljs-string">"FeatureCollection"</span>,<br>        <span class="hljs-string">"features"</span>: [<br>            &#123;<br>                <span class="hljs-string">"type"</span>: <span class="hljs-string">"Feature"</span>,<br>                <span class="hljs-string">"geometry"</span>: &#123;<br>                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Point"</span>,<br>                    <span class="hljs-string">"coordinates"</span>: [<span class="hljs-number">116.338728</span>, <span class="hljs-number">39.913385</span>]<br>                &#125;,<br>                <span class="hljs-string">"properties"</span>: &#123;<br>                    <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç‚¹1"</span>,<br>                &#125;<br>            &#125;<br>        ]<br>    &#125;<br>&#125;<br>map.addSource(<span class="hljs-string">'source1'</span>, mySource)<br>map.addLayer(&#123;<br>    <span class="hljs-string">"id"</span>: <span class="hljs-string">"testLayer"</span>,<br>    <span class="hljs-string">"source"</span>: <span class="hljs-string">'source1'</span>,<br>    <span class="hljs-string">"type"</span>: <span class="hljs-string">"circle"</span>,<br>    <span class="hljs-string">"paint"</span>: &#123;<br>        <span class="hljs-string">"circle-color"</span>: <span class="hljs-string">"#FF0000"</span>,<br>        <span class="hljs-string">"circle-radius"</span>: <span class="hljs-number">20</span><br>    &#125;<br>&#125;);<br><span class="hljs-keyword">const</span> xmin = <span class="hljs-number">116.338728</span>, xmax = <span class="hljs-number">116.405419</span>, step = <span class="hljs-number">0.0001</span><br><span class="hljs-keyword">let</span> currentX = xmin;<br><span class="hljs-keyword">const</span> source1 = map.getSource(<span class="hljs-string">'source1'</span>);<br><span class="hljs-comment">//å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨å®šæœŸä¿®æ”¹é¢œè‰²</span><br>setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>    currentX += step<br>    <span class="hljs-keyword">if</span> (currentX &gt; xmax) &#123;<br>        currentX = xmin;<br>    &#125;<br>    source1.setData(<br>        &#123;<br>            <span class="hljs-string">"type"</span>: <span class="hljs-string">"FeatureCollection"</span>,<br>            <span class="hljs-string">"features"</span>: [<br>                &#123;<br>                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"Feature"</span>,<br>                    <span class="hljs-string">"geometry"</span>: &#123;<br>                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"Point"</span>,<br>                        <span class="hljs-string">"coordinates"</span>: [currentX, <span class="hljs-number">39.913385</span>]<br>                    &#125;,<br>                    <span class="hljs-string">"properties"</span>: &#123;<br>                        <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç‚¹1"</span>,<br>                    &#125;<br>                &#125;<br>            ]<br>        &#125;<br>    );<br>&#125;, <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†å®šæ—¶å™¨æ¥åˆ·æ–°åæ ‡ï¼Œmapboxè¿˜æ”¯æŒ<code>requestAnimationFrame</code>å‡½æ•°æŒ‰å¸§æ¥åˆ·æ–°ï¼Œä½¿å¾—è¿åŠ¨æ›´æµç•…ï¼Œå¯ä»¥çœ‹<a href="https://www.mapbox.cn/mapbox-gl-js/example/animate-point-along-line/" target="_blank" rel="noopener">è¿™ä¸ªä¾‹å­</a></p><h2 id="geojsonæ•°æ®æºçš„ç¼ºé™·"><a href="#geojsonæ•°æ®æºçš„ç¼ºé™·" class="headerlink" title="geojsonæ•°æ®æºçš„ç¼ºé™·"></a>geojsonæ•°æ®æºçš„ç¼ºé™·</h2><p>ä½ ä¸€å®šæ³¨æ„åˆ°äº†æœ¬ç« çš„æ ‡é¢˜â€œæ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼ˆå°æ•°æ®é‡çš„æ–¹å¼ï¼‰â€ï¼Œä¸ºä»€ä¹ˆè¦åŠ å°æ•°æ®é‡è¿™ä¸ªé™åˆ¶å‘¢ï¼Ÿ<br>è¯•æƒ³ï¼Œå‡å¦‚æˆ‘ä»¬æœ‰ä¸€å¼ æ•°ç™¾ä¸‡æ¡æ•°æ®çš„è¡¨ï¼ŒæŠŠè¿™äº›æ•°æ®å…¨è½¬ä¸ºgeojsonå†ä¸¢ç»™mapboxæ¸²æŸ“ï¼Œé‚£å¯¹æœåŠ¡ç«¯ã€ç½‘ç»œã€æµè§ˆå™¨éƒ½å°†é€ æˆæå¤§çš„å‹åŠ›ã€‚<br>è€Œä¸”å³ä½¿ç”µè„‘æ€§èƒ½æä½³èƒ½å¤Ÿæ’‘ä½ï¼Œæ˜¾ç¤ºå™¨å’Œäººçœ¼çš„åˆ†è¾¨ç‡æœ‰é™ï¼Œä¹Ÿæ— æ³•å°†è¿™äº›ç‚¹åˆ†è¾¨å‡ºæ¥ã€‚</p><p>æ‰€ä»¥ã€gisä¸“å®¶ä»¬æå‡ºäº†åˆ†å±‚ã€åˆ‡ç‰‡ç­‰è§£å†³æ–¹æ³•ï¼Œåˆ¶å®šäº†å¤šç§æ•°æ®æºä»¥é€‚åº”å¤§æ•°æ®é‡çš„å±•ç¤ºï¼Œåœ¨æœ¬æ•™ç¨‹çš„ç¬¬å››éƒ¨åˆ†ä¼šè¯¦ç»†æ¶‰åŠã€‚</p><p>geojsonçš„æ–¹å¼èƒ½å¤Ÿæ”¯æ’‘å¤§çº¦ä¸€ä¸‡ä¸ªç‚¹çš„å±•ç¤ºï¼Œåœ¨ç¬¬å››éƒ¨åˆ†ä¹‹å‰ï¼Œæˆ‘ä»¬ä¾ç„¶å°†ä»¥geojsonä¸ºä¸»è¿›è¡Œè®²è§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapbox-glæ•™ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mapbox-glæ•™ç¨‹(2):æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼ˆå°æ•°æ®é‡çš„æ–¹å¼ï¼‰(ä¸Š)</title>
    <link href="/2020/12/25/2020-12-25-mapbox-gl-tutorial-2/"/>
    <url>/2020/12/25/2020-12-25-mapbox-gl-tutorial-2/</url>
    
    <content type="html"><![CDATA[<p><a href="/2020/12/21/2020-12-21-mapbox-gl-tutorial-1/">ä¸Šä¸€ç« </a> çš„hello worldä¸­ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•æ„é€ ä¸€ä¸ªåœ°å›¾å¹¶å±•ç°åœ¨domå†…ï¼Œä½†åªæ˜¯ä¸€ä¸ªèƒŒæ™¯åœ°å›¾è€Œå·²ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰æ•°æ®ã€‚</p><h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><p>å…ˆçœ‹ä¸‹demoï¼Œæˆ‘ä»¬åœ¨åœ°å›¾ä¸Šæ·»åŠ ä¸¤ä¸ªçº¢ç‚¹</p><div>    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'></script>    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css' rel='stylesheet'/>    <div id='map' style='width: 90%; height: 300px;'></div>    <script>        mapboxgl.accessToken = 'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA';        const map = new mapboxgl.Map({            container: 'map',            style: 'mapbox://styles/mapbox/streets-v9',            center: [116.405419, 39.923568],            zoom: 11        });        map.on('load', function () {            const mySource = {                "type": "geojson",                "data": {                    "type": "FeatureCollection",                    "features": [{                        "type": "Feature",                        "geometry": {                            "type": "Point",                            "coordinates": [116.338728, 39.913385]                        },                        "properties": {                            "name": "ç‚¹1",                        }                    }, {                        "type": "Feature",                        "geometry": {                            "type": "Point",                            "coordinates": [116.405419, 39.923568]                        },                        "properties": {                            "name": "ç‚¹1",                            "type": "æµ‹è¯•ç±»å‹"                        }                    }]                }            };            map.addSource('source1', mySource);            map.addLayer({                "id": "testLayer",                "source": 'source1',                "type": "circle",                "paint": {                    "circle-color": "#FF0000",                    "circle-radius": 20                }            });        });    </script></div><p>è¿™æ¬¡ï¼Œæˆ‘ä»¬ä¸ç›´æ¥çœ‹ä»£ç ï¼Œå…ˆçœ‹ä¸€ä¸‹mapboxçš„å¯¹è±¡æ¨¡å‹ï¼š</p><h1 id="mapboxå¯¹è±¡æ¨¡å‹"><a href="#mapboxå¯¹è±¡æ¨¡å‹" class="headerlink" title="mapboxå¯¹è±¡æ¨¡å‹"></a>mapboxå¯¹è±¡æ¨¡å‹</h1><p><img src="/myimgs/20201225/1.jpg" alt="mapboxå¯¹è±¡æ¨¡å‹"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œmapboxçš„å¯¹è±¡åˆ†ä¸ºäº†è‹¥å¹²ä¸ªå±‚çº§ï¼š</p><h2 id="åœ°å›¾-map"><a href="#åœ°å›¾-map" class="headerlink" title="åœ°å›¾(map)"></a>åœ°å›¾(map)</h2><p>ä¸Šä¸€ç« ä¸­æˆ‘ä»¬å·²ç»äº†è§£åˆ°ï¼Œè¦å±•ç°åœ°å›¾ï¼Œå…ˆè¦åˆ›å»ºä¸€ä¸ªmapå¯¹è±¡å¹¶å°†å…¶ç»‘å®šåˆ°domä¸Šã€‚</p><p>ä¸€ä¸ªåœ°å›¾ä¸‹é¢åŒ…å«äº†å¤šä¸ªå›¾å±‚ã€‚</p><h2 id="å›¾å±‚-layer"><a href="#å›¾å±‚-layer" class="headerlink" title="å›¾å±‚(layer)"></a>å›¾å±‚(layer)</h2><p>ä¸€ä¸ªåœ°å›¾ä¸‹é¢åŒ…å«äº†å¤šä¸ªå›¾å±‚ï¼Œä¾‹å¦‚ä¸Šç« çš„demoä¸­ï¼ŒèƒŒæ™¯åœ°å›¾é‡Œä¹ŸåŒ…å«äº†è¡—é“ã€æ°´ç³»ã€å½¢çŠ¶åŒºåŸŸç­‰å›¾å±‚(è¿™äº›å›¾å±‚åœ¨é…ç½®äº†styleå‚æ•°åï¼Œè‡ªåŠ¨æ·»åŠ åˆ°äº†åœ°å›¾ä¸­)ï¼Œ<br>æœ¬ç« çš„demoä¸­æˆ‘ä»¬ç”»çš„ä¸¤ä¸ªçº¢ç‚¹ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªå›¾å±‚ä¸­ã€‚</p><p>å›¾å±‚ä¸‹åŒ…å«äº†æ•°æ®å’Œæ ·å¼ã€‚</p><h2 id="æ•°æ®-source"><a href="#æ•°æ®-source" class="headerlink" title="æ•°æ®(source)"></a>æ•°æ®(source)</h2><p>sourceçš„ä¸­æ–‡ç¿»è¯‘æ¯”è¾ƒå¤šï¼Œè¯‘ä½œâ€œæ•°æ®æºâ€ã€â€œæ¥æºâ€ã€â€œè¦ç´ æºâ€ä¹‹ç±»ã€‚ã€‚sourceå¯ä»¥ç†è§£ä¸ºä¸€å¼ æ•°æ®åº“è¡¨ï¼Œæˆ‘ä»¬æŠŠè¡¨ä¸­çš„æ•°æ®ä¼ ç»™mapboxï¼Œæ‰èƒ½æŠŠå®ƒå±•ç°å‡ºæ¥ã€‚</p><p>æ•°æ®ç”±å¤šä¸ªè¦ç´ ç»„æˆï¼Œæ¯ä¸ªè¦ç´ å¯ä»¥ç†è§£ä¸ºè¡¨ä¸­çš„ä¸€è¡Œæ•°æ®ã€‚</p><h2 id="æ ·å¼-style"><a href="#æ ·å¼-style" class="headerlink" title="æ ·å¼(style)"></a>æ ·å¼(style)</h2><p>æ ·å¼å°±æ˜¯å±•ç°æ•°æ®çš„æ–¹å¼ï¼Œä¾‹å¦‚æœ¬ç« demoä¸­æŠŠæ•°æ®å±•ç°ä¸ºçº¢è‰²çš„åœ†ç‚¹ï¼Œå°±æ˜¯æ ·å¼çš„ä½œç”¨ã€‚</p><h2 id="è¦ç´ -feature"><a href="#è¦ç´ -feature" class="headerlink" title="è¦ç´ (feature)"></a>è¦ç´ (feature)</h2><p>æ¯ä¸ªè¦ç´ å¯ä»¥ç†è§£ä¸ºè¡¨ä¸­çš„ä¸€è¡Œæ•°æ®ã€‚è¦ç´ ä¸­åŒ…å«äº†ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œ<strong>å±æ€§(properties)</strong>å’Œ<strong>å½¢çŠ¶(geometry)</strong>ã€‚<br>å±æ€§å°±æ˜¯å¸¸è§„çš„å­—æ®µï¼Œä¸€èˆ¬ç”¨key-valueçš„å½¢å¼è¡¨ç¤ºï¼Œå¦‚<code>{name:&quot;å¼ ä¸‰&quot;,age:25}</code>ã€‚<br>å½¢çŠ¶å­˜æ”¾äº†è¦ç´ çš„åæ ‡ä¿¡æ¯ã€‚</p><h1 id="demoä»£ç è§£æ"><a href="#demoä»£ç è§£æ" class="headerlink" title="demoä»£ç è§£æ"></a>demoä»£ç è§£æ</h1><p>äº†è§£äº†mapboxçš„å¯¹è±¡æ¨¡å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹ç…§æ¨¡å‹æ¥çœ‹ä»£ç äº†:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css'</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">'stylesheet'</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'map'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'width: 90%; height: 300px;'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript"><br>    mapboxgl.accessToken = <span class="hljs-string">'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA'</span>;<br>    <span class="hljs-comment">//åœ°å›¾</span><br>    <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> mapboxgl.Map(&#123;<br>        container: <span class="hljs-string">'map'</span>,<br>        style: <span class="hljs-string">'mapbox://styles/mapbox/streets-v9'</span>,<br>        center: [<span class="hljs-number">116.405419</span>, <span class="hljs-number">39.923568</span>],<br>        zoom: <span class="hljs-number">11</span><br>    &#125;);<br><br>    map.on(<span class="hljs-string">'load'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>&#123;<span class="hljs-comment">//åœ°å›¾åˆå§‹åŒ–ç»“æŸåçš„å›è°ƒå‡½æ•°ï¼Œæ“ä½œåœ°å›¾å¯¹è±¡ä¸€èˆ¬éƒ½åœ¨å›è°ƒå‡½æ•°ä¸­è¿›è¡Œï¼Œå¦åˆ™å¯èƒ½ç”±äºè¿˜æ²¡åˆå§‹åŒ–å®Œæ¯•è€Œäº§ç”Ÿä¸€äº›å¥‡æ€ªçš„é—®é¢˜</span><br><br>        <span class="hljs-comment">//æ•°æ®æº</span><br>        <span class="hljs-keyword">const</span> mySource = &#123;<br>            <span class="hljs-string">"type"</span>: <span class="hljs-string">"geojson"</span>,<span class="hljs-comment">//æ³¨é‡Š1 æ•°æ®ç±»å‹</span><br>            <span class="hljs-string">"data"</span>: &#123;<span class="hljs-comment">//æ³¨é‡Š2 geojson</span><br>                <span class="hljs-string">"type"</span>: <span class="hljs-string">"FeatureCollection"</span>,<br>                <span class="hljs-string">"features"</span>: [<br>                    &#123;<span class="hljs-comment">//è¦ç´ </span><br>                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"Feature"</span>,<br>                        <span class="hljs-string">"geometry"</span>: &#123;<span class="hljs-comment">//å½¢çŠ¶</span><br>                            <span class="hljs-string">"type"</span>: <span class="hljs-string">"Point"</span>,<br>                            <span class="hljs-string">"coordinates"</span>: [<span class="hljs-number">116.338728</span>, <span class="hljs-number">39.913385</span>]<span class="hljs-comment">//ç‚¹çš„ç»çº¬åº¦åæ ‡</span><br>                        &#125;,<br>                        <span class="hljs-string">"properties"</span>: &#123;<span class="hljs-comment">//å±æ€§</span><br>                            <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç‚¹1"</span>,<br>                        &#125;<br>                    &#125;,<br>                    &#123;<span class="hljs-comment">//å¦ä¸€ä¸ªè¦ç´ </span><br>                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"Feature"</span>,<br>                        <span class="hljs-string">"geometry"</span>: &#123;<br>                            <span class="hljs-string">"type"</span>: <span class="hljs-string">"Point"</span>,<br>                            <span class="hljs-string">"coordinates"</span>: [<span class="hljs-number">116.405419</span>, <span class="hljs-number">39.923568</span>]<br>                        &#125;,<br>                        <span class="hljs-string">"properties"</span>: &#123;<br>                            <span class="hljs-string">"name"</span>: <span class="hljs-string">"ç‚¹1"</span>,<br>                            <span class="hljs-string">"type"</span>: <span class="hljs-string">"æµ‹è¯•ç±»å‹"</span><br>                        &#125;<br>                    &#125;<br>                ]<br>            &#125;<br>        &#125;<br><br>        map.addSource(<span class="hljs-string">'source1'</span>, mySource)<span class="hljs-comment">//å°†æ•°æ®æ·»åŠ åˆ°åœ°å›¾ï¼ŒæŒ‡å®šè¿™ä»½æ•°æ®çš„idä¸ºsource1ï¼Œidå¿…é¡»å”¯ä¸€</span><br><br>        <span class="hljs-comment">//æ„é€ ä¸€ä¸ªå›¾å±‚å¹¶æ·»åŠ åˆ°åœ°å›¾</span><br>        map.addLayer(&#123;<br>            <span class="hljs-string">"id"</span>: <span class="hljs-string">"testLayer"</span>,<span class="hljs-comment">//å›¾å±‚idï¼Œå¿…é¡»å”¯ä¸€</span><br>            <span class="hljs-string">"source"</span>: <span class="hljs-string">'source1'</span>,<span class="hljs-comment">//æŒ‡å®šæ­¤å›¾å±‚ä½¿ç”¨æ•°æ®æºsource1</span><br>            <span class="hljs-comment">//ä¸‹é¢æ˜¯å›¾å±‚çš„æ ·å¼ä¿¡æ¯</span><br>            <span class="hljs-string">"type"</span>: <span class="hljs-string">"circle"</span>,<span class="hljs-comment">//æ ·å¼ç±»å‹ä¸ºåœ†ç‚¹</span><br>            <span class="hljs-string">"paint"</span>: &#123;<br>                <span class="hljs-string">"circle-color"</span>: <span class="hljs-string">"#FF0000"</span>,<span class="hljs-comment">//é¢œè‰²</span><br>                <span class="hljs-string">"circle-radius"</span>: <span class="hljs-number">20</span><span class="hljs-comment">//åœ†ç‚¹åŠå¾„</span><br>            &#125;<br>        &#125;);<br>    &#125;);<br></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨é‡Š1:</strong><br>mapboxæä¾›å¤šç§ç±»å‹çš„sourceï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº†æœ€å®¹æ˜“ç†è§£çš„geojson sourceï¼Œå…¶å®ƒçš„ç±»å‹æˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚ä¸­è§åˆ°</p><p><strong>æ³¨é‡Š2:</strong><br>dataé‡Œä¼ å…¥äº†ä¸€ä¸ªç‰¹æ®Šæ ¼å¼jsonï¼Œè¿™ç§æ ¼å¼çš„jsonæˆ‘ä»¬ç§°ä¸ºgeojsonï¼Œå®ƒä»¥æŒ‡å®šçš„æ ¼å¼æè¿°äº†è¦ç´ çš„å±æ€§å’Œå½¢çŠ¶ï¼Œæœ‰å…³geojsonçš„è¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« æè¿°</p>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapbox-glæ•™ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mapbox-glæ•™ç¨‹(1):åˆè¯†mapboxgl</title>
    <link href="/2020/12/21/2020-12-21-mapbox-gl-tutorial-1/"/>
    <url>/2020/12/21/2020-12-21-mapbox-gl-tutorial-1/</url>
    
    <content type="html"><![CDATA[<h1 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h1><p>æˆ‘ä»¬å…ˆæ¥ç¼–å†™ä¸€ä¸ªhello worldï¼Œå¹¶çœ‹çœ‹æ•ˆæœï¼š</p><div>    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'></script>    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css' rel='stylesheet' />    <div id='map' style='width: 90%; height: 300px;'></div>    <script>        mapboxgl.accessToken = 'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA';        var map = new mapboxgl.Map({            container: 'map',            style: 'mapbox://styles/mapbox/streets-v9',            center: [116.403119,39.925338],            zoom: 9        });    </script></div><p>ä»£ç å¦‚ä¸‹ï¼ˆhtmlã€bodyä¹‹ç±»çš„æ ‡ç­¾å°±çœç•¥äº†å“ˆï¼‰ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css'</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">'stylesheet'</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'map'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'width: 90%; height: 300px;'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript"><br>    mapboxgl.accessToken = <span class="hljs-string">'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA'</span>;<br>    <span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> mapboxgl.Map(&#123;<br>        container: <span class="hljs-string">'map'</span>,<br>        style: <span class="hljs-string">'mapbox://styles/mapbox/streets-v9'</span>,<br>        center: [<span class="hljs-number">116.403119</span>,<span class="hljs-number">39.925338</span>],<br>        zoom: <span class="hljs-number">9</span><br>    &#125;);<br></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é€è¡Œè§£é‡Šä¸€ä¸‹ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼Œå¼•å…¥mapboxçš„jså’Œcss</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.js'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://api.tiles.mapbox.com/mapbox-gl-js/v1.1.1/mapbox-gl.css'</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">'stylesheet'</span> /&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œå†™ä¸€ä¸ªdivæ¥å±•ç°åœ°å›¾ï¼Œç»™å®ƒæŒ‡å®šid</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'map'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'width: 90%; height: 300px;'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œmapboxè®¾ç½®ä¸€ä¸ªtokenæ‰èƒ½è·å–å®ƒå®˜æ–¹å‘å¸ƒçš„åœ°å›¾ï¼Œè¿™é‡Œç”¨äº†ä¸€ä¸ªå…¬å¼€çš„tokenï¼Œä½ ä¹Ÿå¯ä»¥å»<a href="https://account.mapbox.com/access-tokens/" target="_blank" rel="noopener">è¿™é‡Œ</a>è‡ªå·±ç”³è¯·ä¸€ä¸ª</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">mapboxgl.accessToken = <span class="hljs-string">'pk.eyJ1IjoiY2hlbnNodXNodSIsImEiOiJjazNvM3A2MjkwMDJjM2VzNHhiMXppdjZwIn0.JvnD0CzpAYeqFRGQn8fClA'</span>;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯ä¼ å…¥å‚æ•°æ¥æ„é€ mapå¯¹è±¡äº†:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> mapboxgl.Map(&#123;<br>    <span class="hljs-attr">container</span>: <span class="hljs-string">'map'</span>,<br>    <span class="hljs-attr">center</span>: [<span class="hljs-number">116.403119</span>,<span class="hljs-number">39.925338</span>],<br>    <span class="hljs-attr">zoom</span>: <span class="hljs-number">9</span>,<br>    <span class="hljs-attr">style</span>: <span class="hljs-string">'mapbox://styles/mapbox/streets-v9'</span>,<br><br>&#125;);<br></code></pre></td></tr></table></figure><p>å„å‚æ•°è¯´æ˜å¦‚ä¸‹:</p><table><thead><tr><th>å‚æ•°å</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>container</td><td>å°†åœ°å›¾åœ¨æŒ‡å®šçš„domä¸­å±•ç¤ºï¼Œè¿™é‡Œå±•ç¤ºåœ¨æˆ‘ä»¬åˆšæ‰å†™çš„idä¸ºâ€mapâ€çš„divé‡Œ</td></tr><tr><td>center</td><td>åœ°å›¾åˆå§‹åŒ–æ—¶çš„ä¸­å¿ƒåæ ‡ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä½ è¦å±•ç¤ºçš„ä½ç½®çš„åæ ‡ï¼Œå¯ä»¥ä»<a href="http://api.map.baidu.com/lbsapi/getpoint/index.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ç‚¹é€‰è·å–</td></tr><tr><td>zoom</td><td>åœ°å›¾åˆå§‹åŒ–æ—¶çš„ç¼©æ”¾ç­‰çº§ï¼Œè¶Šå¤§åˆ™è¶Šæ¯”ä¾‹å°ºè¶Šå¤§</td></tr><tr><td>style</td><td>åœ°å›¾æ ·å¼ï¼Œè¯¦è§ä¸‹é¢çš„æè¿°</td></tr></tbody></table><h2 id="style"><a href="#style" class="headerlink" title="style"></a>style</h2><p>mapboxçš„styleæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„æ¦‚å¿µï¼Œä¸arcgisã€openlayersç­‰äº§å“ä¸­çš„æ ·å¼æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œå®ƒå®é™…ä¸Šæ˜¯æ•°æ®æºã€å›¾å±‚ã€æ ·å¼ç­‰ä¿¡æ¯çš„æ±‡æ€»ã€‚<br>æˆ‘ä»¬åé¢å†è¯¦ç»†åœ°å­¦ä¹ å®ƒï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªurlæˆ–è€…jsonï¼Œé…ç½®äº†åœ°å›¾å±•ç°ç›¸å…³çš„é‡è¦ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œé…ç½®ä¸åŒçš„styleä¼šåœ¨åœ°å›¾ä¸Šå±•ç°å‡ºä¸åŒçš„æ•°æ®å’Œå¼æ ·ã€‚</p><p>æœ¬èŠ‚ä¸­æˆ‘ä»¬ä»…å­¦ä¹ é€šè¿‡urlæ¥å±•ç°mapboxå®˜æ–¹æä¾›çš„èƒŒæ™¯åœ°å›¾ã€‚</p><p>ä¸‹é¢åˆ—å‡ºäº†å‡ ç§å¸¸ç”¨çš„style idï¼Œä½ å¯ä»¥é¢„è§ˆå¹¶é€‰æ‹©ä¸€ä¸ªä½ å–œæ¬¢çš„idï¼Œç„¶åç”¨â€™mapbox://styles/mapbox/â€˜+idæ¥é…ç½®å®ƒä»¬</p><div>    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-language/v0.10.1/mapbox-gl-language.js'></script>    <div id="menu">        <input id="streets-v9" type="radio" name="rtoggle" value="streets" checked="checked"/><label>streets-v9</label>&nbsp;        <input id="outdoors-v10" type="radio" name="rtoggle" value="light" /><label>outdoors-v10</label>&nbsp;        <input id="dark-v9" type="radio" name="rtoggle" value="light" /><label>dark-v9</label>&nbsp;        <input id="light-v9" type="radio" name="rtoggle" value="light" /><label>light-v9</label>&nbsp;        <input id="satellite-streets-v9" type="radio" name="rtoggle" value="light" /><label>satellite-streets-v9</label>&nbsp;        <input id="traffic-day-v2" type="radio" name="rtoggle" value="light" /><label>traffic-day-v2</label>&nbsp;        <input id="traffic-night-v2" type="radio" name="rtoggle" value="light" /><label>traffic-night-v2</label>&nbsp;    </div>    <div id='map1' style='width: 90%; height: 300px;'></div>    <script>        var map1 = new mapboxgl.Map({            container: 'map1',            style: 'mapbox://styles/mapbox/streets-v9',            center: [116.403119,39.925338],            zoom: 9        });        mapboxgl.setRTLTextPlugin('https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.1.0/mapbox-gl-rtl-text.js');        var languageControl = new MapboxLanguage({            defaultLanguage: 'zh'        });        map1.addControl(languageControl);        var layerList = document.getElementById('menu');        var inputs = layerList.getElementsByTagName('input');        function switchLayer(layer) {            var layerId = layer.target.id;            map1.setStyle('mapbox://styles/mapbox/' + layerId);            map1.removeControl(languageControl);            map1.addControl(languageControl);        }        for (var i = 0; i < inputs.length; i++) {            inputs[i].onclick = switchLayer;        }    </script></div><br/><p>æ›´å¤šçš„æ ·å¼ï¼Œä½ å¯ä»¥ä»<a href="https://www.mapbox.com/gallery/" target="_blank" rel="noopener">è¿™é‡Œæ‰¾åˆ°</a>ï¼Œç„¶åç”³è¯·ä¸€ä¸ªtokenå¹¶ç‚¹å‡»â€œExpolerâ€-&gt;â€œAdd Decimal  to your accountâ€å°†å…¶å¤åˆ¶åˆ°ä½ çš„tokenä¸‹æ¥ä½¿ç”¨</p><p>å½“ç„¶ï¼Œè¿™ç§styleçš„è®¾ç½®æ–¹å¼è™½ç„¶ä¾¿æ·ï¼Œä½†æ˜¯å¤ªä¸çµæ´»äº†ï¼Œåç»­çš„ç« èŠ‚ä¸­æˆ‘ä»¬å°†ä½¿ç”¨è‡ªå®šä¹‰jsonæ¥é…ç½®å®ƒ</p><h1 id="mapbox-glçš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿"><a href="#mapbox-glçš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿" class="headerlink" title="mapbox-glçš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿"></a>mapbox-glçš„ä¼˜åŠ¿å’ŒåŠ£åŠ¿</h1><p>å¦‚æœä½ ç”¨è¿‡openlayersã€leafletæˆ–æ˜¯arcgis jsï¼Œä½ ä¼šå‘ç°mapbox-glæ„å»ºmapå¯¹è±¡çš„è¯­æ³•å’Œå®ƒä»¬å¾ˆç›¸åƒã€‚äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬æƒ³åšä¸€ä¸ªwebç«¯çš„äºŒç»´gisåº”ç”¨ï¼Œè¿™å‡ æ¬¾æ¡†æ¶ä¹Ÿæ˜¯ä»…æœ‰çš„æ¯”è¾ƒé è°±çš„é€‰æ‹©ã€‚</p><p>arcgis jsä½œä¸ºesriçš„äº§å“ï¼ŒåŠŸèƒ½å¼ºå¤§ç¨³å®šï¼Œè€Œä¸”å®ƒæ˜¯requireé£æ ¼ç¼–å†™çš„ï¼ŒæŒ‰éœ€åŠ è½½çš„æœºåˆ¶ä½¿æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒæ–‡ä»¶ä½“ç§¯çˆ†ç‚¸ã€‚ä½†ä¸€ä¸ªå¾ˆè‡´å‘½çš„é—®é¢˜æ˜¯ï¼Œå®ƒä¸å¼€æºï¼Œä½¿å¾—æ·±åº¦è°ƒè¯•å’Œæ‰©å±•å¾ˆæ˜¯éº»çƒ¦ã€‚</p><p>leafletçš„ä¼˜åŠ¿æ˜¯è½»é‡çº§å’Œå¯¹ieç­‰æµè§ˆå™¨çš„è‰¯å¥½å…¼å®¹ï¼Œå¦‚æœä½ éœ€è¦å…¼å®¹ieæˆ–æ˜¯åšä¸€äº›è½»é‡çº§ã€å°æ•°æ®é‡çš„å¼€å‘ï¼Œleafletæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚</p><p>openlayersæ˜¯å¯¹é¢å‘å¯¹è±¡å¼€å‘äººå‘˜éå¸¸å‹å¥½çš„ä¸€ä¸ªæ¡†æ¶ï¼Œmapã€layerã€featureã€geometryçš„åˆ†å±‚éå¸¸æ¸…æ™°ï¼Œå†™èµ·æ¥éå¸¸çš„OOPï¼Œå¦‚æœæœ‰å¾ˆå¤æ‚çš„å‰ç«¯é€»è¾‘ï¼Œopenlayerså†™å‡ºæ¥çš„ä»£ç æ¯”å…¶å®ƒå‡ ä¸ªéƒ½å®¹æ˜“ç»´æŠ¤ã€‚<br>ç¼ºç‚¹æ˜¯æ€§èƒ½ä¸€èˆ¬ï¼Œè€Œä¸”å¯¹äºä¸€äº›æ–°æŠ€æœ¯æœ‰å°‘é‡å¥‡æ€ªçš„bugï¼Œæ¯”å¦‚çŸ¢é‡ç“¦ç‰‡ç»˜åˆ¶è·¨ç“¦ç‰‡çš„ç‚¹ç»˜åˆ¶ä¸å®Œæ•´ã€‚</p><p>è¿˜æœ‰ä¸€ç±»æ˜¯è¿è¥å•†å¼€å‘çš„æ¡†æ¶ï¼Œæ¯”å¦‚ç™¾åº¦å’Œé«˜å¾·ï¼Œè¿™ç±»æ¡†æ¶ä¼˜åŠ¿æ˜¯æ–¹ä¾¿ä¸”ä¸­æ–‡æ–‡æ¡£ä¸°å¯Œã€‚ä½†æ˜¯å¿…é¡»æ¥å…¬ç½‘ã€ä¸å¼€æºã€å®šåˆ¶æ€§å·®ç­‰é—®é¢˜ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨éœ€è¦å¼€å‘å¼ºä¸šåŠ¡åŠŸèƒ½æ—¶å‡ ä¹ä¸ä¼šå»è€ƒè™‘å®ƒã€‚</p><p>é‚£ä¹ˆï¼Œmapboxæœ‰å“ªäº›ä¼˜åŠ£å‘¢ï¼Ÿæœ€å¤§çš„ä¼˜åŠ£éƒ½æ¥æºäºï¼š<strong>mapbox-glæ˜¯åŸºäºwebglå¼€å‘çš„</strong>ã€‚</p><p>ğŸ‘<strong>é«˜æ€§èƒ½</strong> ç”¨jsè¿›è¡Œæ•°æ®åŸºæœ¬å¤„ç†ï¼Œç„¶åå°±ä¸¢ç»™webglå»æ¸²æŸ“äº†ï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸å¼ºæ‚ã€‚ä»¥æˆ‘çš„ç ´ç¬”è®°æœ¬æ¥æµ‹è¯•geojsonç‚¹å›¾å±‚çš„åŠ è½½ï¼Œ<br>openlayersåŠ è½½ä¸€åƒä¸ªç‚¹å·¦å³å°±å¼€å§‹å¡é¡¿äº†ï¼Œè€Œmapboxå¯ä»¥æ”¯æ’‘ä¸¤ä¸‡ä¸ªç‚¹å·¦å³ã€‚å¦‚æœç”¨mapboxçš„webglæ¥å£æ¥æ“ä½œï¼Œç”šè‡³å¯ä»¥æ”¯æ’‘åˆ°ç™¾ä¸‡çº§ã€‚</p><p>ğŸ‘<strong>å¯è§†åŒ–æ•ˆæœä¸°å¯Œ</strong> mapbox-glå¼€æ”¾äº†webglçš„æ“ä½œæ¥å£ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨glå¯¹è±¡æˆ–æ˜¯å°†glå¯¹è±¡ä¸¢ç»™Three.jsç­‰æ¡†æ¶ï¼Œä»è€Œåšå‡ºç‚«é…·çš„æ•ˆæœã€‚</p><p>ğŸ‘<strong>ä»£ç å±‚çº§ä¸å¤Ÿæ¸…æ™°</strong> ä½†åŸºäºwebglå¼€å‘ï¼Œé€ æˆäº†æ•°æ®ä¸æ¸²æŸ“çš„é«˜åº¦åˆ†ç¦»ï¼Œä½¿å¾—mapboxçš„ä»£ç å±‚æ¬¡ä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œç”šè‡³äºæ ¹æœ¬å°±æ²¡æœ‰featureå’Œgeometryï¼ˆè€Œæ˜¯ç”¨jsonå»ä»£æ›¿ï¼‰ï¼Œä¸æ˜¯å¾ˆå®¹æ˜“ç»´æŠ¤ï¼Œåé¢çš„ç« èŠ‚ä¸­æˆ‘ä»¬ä¼šä½“ä¼šåˆ°è¿™ç‚¹ã€‚<br>æ‰€ä»¥å¼€å‘ä¹‹å‰ï¼Œä½ åº”è¯¥å……åˆ†è®¾è®¡ä»£ç ç»“æ„ä»¥é˜²æ­¢åæœŸçš„æ··ä¹±ï¼ˆå½“ç„¶ï¼Œopenlayersè™½ç„¶å±‚æ¬¡æ¸…æ™°ï¼Œä½†ä¸å¥½å¥½è®¾è®¡ä¾ç„¶ä¼šæ··ä¹±ï¼Œåªæ˜¯æ¯”mapboxå®¹æ˜“ç»´æŠ¤ä¸€äº›ï¼‰ã€‚</p><p>ğŸ‘<strong>å…¼å®¹æ€§ä¸é«˜</strong> åœ¨IEä¸Šå®Œå…¨æ— æ³•å±•ç¤ºï¼Œä½†å¾®è½¯è‡ªå·±éƒ½æŠŠIEä¸¢æ‰äº†ï¼Œé™¤äº†åº”ä»˜å®ˆæ—§çš„ç”¨æˆ·ï¼Œè¿™æ¡ä¹Ÿä¸æ˜¯å¤§é—®é¢˜ã€‚</p><p>äº†è§£äº†ä»¥ä¸Šä¼˜åŠ£ï¼Œç›¸ä¿¡ä½ ä¼šå¯¹ä½ çš„çš„é¡¹ç›®æ˜¯å¦è¯¥ä½¿ç”¨mapboxæœ‰è‡ªå·±çš„åˆ¤æ–­ã€‚</p><h1 id="æœ¬æ•™ç¨‹è®¡åˆ’ç« èŠ‚"><a href="#æœ¬æ•™ç¨‹è®¡åˆ’ç« èŠ‚" class="headerlink" title="æœ¬æ•™ç¨‹è®¡åˆ’ç« èŠ‚"></a>æœ¬æ•™ç¨‹è®¡åˆ’ç« èŠ‚</h1><p>æœ¬æ•™ç¨‹å°†æŒ‰ä»¥ä¸‹ç« èŠ‚ï¼Œé€æ­¥ä»‹ç»å’Œå­¦ä¹ mapboxï¼ˆå•Šï¼Œè¿™å‘å¥½å¤§ï¼Œæ…¢æ…¢æ–½å·¥<del>~</del>ï¼‰</p><h2 id="ç¬¬ä¸€éƒ¨åˆ†-ç®€ä»‹"><a href="#ç¬¬ä¸€éƒ¨åˆ†-ç®€ä»‹" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ† ç®€ä»‹"></a>ç¬¬ä¸€éƒ¨åˆ† ç®€ä»‹</h2><p>è¿™éƒ¨åˆ†æˆ‘ä»¬å…ˆç¼–å†™ä¸€ä¸ªhello worldï¼Œä»‹ç»mapboxçš„åŸºæœ¬æƒ…å†µï¼Œå¹¶ä¸å…¶å®ƒå‰ç«¯åœ°å›¾æ¡†æ¶åšæ¯”è¾ƒï¼Œä»¥å¸®åŠ©ä½ å¿«é€Ÿé€‰å‹å’Œä¸Šæ‰‹</p><p><a href="/2020/12/21/2020-12-21-mapbox-gl-tutorial-1">mapbox-glæ•™ç¨‹(1):åˆè¯†mapboxgl</a></p><h2 id="ç¬¬äºŒéƒ¨åˆ†-ç®€å•çš„æ•°æ®åŠ è½½ä¸å±•ç°"><a href="#ç¬¬äºŒéƒ¨åˆ†-ç®€å•çš„æ•°æ®åŠ è½½ä¸å±•ç°" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ† ç®€å•çš„æ•°æ®åŠ è½½ä¸å±•ç°"></a>ç¬¬äºŒéƒ¨åˆ† ç®€å•çš„æ•°æ®åŠ è½½ä¸å±•ç°</h2><p>å®Œæˆäº†hello worldï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šå±•ç°æˆ‘ä»¬è‡ªå·±çš„æ•°æ®ï¼Œä»è€Œå®ç°å®é™…çš„ä¸šåŠ¡åŠŸèƒ½äº†</p><p><a href="/2020/12/25/2020-12-25-mapbox-gl-tutorial-2">mapbox-glæ•™ç¨‹(2):æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼ˆå°æ•°æ®é‡çš„æ–¹å¼ï¼‰(ä¸Š)</a></p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(3):æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼ˆå°æ•°æ®é‡çš„æ–¹å¼ï¼‰(ä¸‹)</a><br>ä»‹ç»å¦‚ä½•å°†è‡ªå®šä¹‰æ•°æ®æ·»åŠ åˆ°åœ°å›¾ä¸Šï¼Œå¹¶æŒ‰æˆ‘ä»¬éœ€è¦çš„æ ·å¼è¿›è¡Œå±•ç°</p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(4):é€‚é…å›½å†…åº•å›¾</a><br>mapboxå®˜æ–¹çš„åº•å›¾å¯¹å›½å†…ç”¨æˆ·å¹¶ä¸æ˜¯å¾ˆå‹å¥½ï¼Œè¿™é‡Œä»‹ç»ä¸€äº›æ”¹è‰¯æ–¹å¼</p><h2 id="ç¬¬ä¸‰éƒ¨åˆ†-åœ°å›¾äº¤äº’"><a href="#ç¬¬ä¸‰éƒ¨åˆ†-åœ°å›¾äº¤äº’" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ† åœ°å›¾äº¤äº’"></a>ç¬¬ä¸‰éƒ¨åˆ† åœ°å›¾äº¤äº’</h2><p>å®Œæˆäº†æ•°æ®åŠ è½½åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä¸åœ°å›¾è¿›è¡Œäº¤äº’</p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(5):å¸¸è§äº‹ä»¶ä¸ç»„ä»¶</a></p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(6):é€šè¿‡ç¬¬ä¸‰æ–¹ç»„ä»¶æ‰©å±•çš„æ•ˆæœ</a></p><h2 id="ç¬¬å››éƒ¨åˆ†-æ•°æ®ä¸å›¾å±‚"><a href="#ç¬¬å››éƒ¨åˆ†-æ•°æ®ä¸å›¾å±‚" class="headerlink" title="ç¬¬å››éƒ¨åˆ† æ•°æ®ä¸å›¾å±‚"></a>ç¬¬å››éƒ¨åˆ† æ•°æ®ä¸å›¾å±‚</h2><p>ç¬¬äºŒéƒ¨åˆ†å·²ç»ä»‹ç»äº†å¦‚ä½•åŠ è½½å®˜æ–¹åœ°å›¾å’Œè‡ªå®šä¹‰æ•°æ®ï¼Œç„¶è€Œå¾ˆå¤šæƒ…å†µä¸‹è¿™å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨å†…ç½‘ç¯å¢ƒä¸‹æˆ‘ä»¬æ— æ³•ä½¿ç”¨å®˜ç½‘çš„åº•å›¾ï¼Œé‚£æˆ‘ä»¬éœ€è¦è‡ªå·±å‘å¸ƒå’ŒåŠ è½½å†…ç½‘åº•å›¾æ¥æ›¿æ¢å®ƒã€‚</p><p>åˆå¦‚ï¼Œæ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œç”¨ç¬¬äºŒéƒ¨åˆ†ä»‹ç»çš„æ·»åŠ geojsonå›¾å±‚çš„æ–¹å¼ä¼šä½¿å¾—æµè§ˆå™¨å¡æ­»ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ä¸€äº›æ›´é«˜æ•ˆçš„æ–¹æ³•ã€‚</p><p>æˆ–æ˜¯éœ€è¦é«˜çº§ç‰¹æ•ˆçš„åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨mapboxçš„webglæ¥å£æ¥æ‰©å±•è‡ªå®šä¹‰å›¾å±‚ã€‚</p><p>è¿™äº›ä¾‹å­ä¸­æˆ‘ä»¬å‘ç°ï¼Œè¦æŠŠgisåŠŸèƒ½åšç²¾ï¼Œå¾€å¾€æ˜¯éœ€è¦å‰åç«¯æŠ€æœ¯å¯†åˆ‡é…åˆçš„ï¼Œæ‰€ä»¥å¦‚æœä½ æ˜¯ä¸€ä½çº¯å‰ç«¯/åç«¯ï¼Œæœ‰äº›å†…å®¹çœ‹èµ·æ¥ä¼šæ¯”è¾ƒåƒåŠ›ï¼Œ<br>ä½ éœ€è¦è¡¥ä¹ ä¸€ä¸‹ç›¸å…³çŸ¥è¯†ï¼Œæˆ–è€…æ‰¾ä¸€ä½åç«¯/å‰ç«¯æ¥å¸®åŠ©ä½ ã€‚</p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(7):æ …æ ¼ç“¦ç‰‡å›¾å±‚çš„å‘å¸ƒä¸ä½¿ç”¨</a></p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(8):çŸ¢é‡ç“¦ç‰‡å›¾å±‚çš„å‘å¸ƒä¸ä½¿ç”¨</a></p><p><a href="#æœ¬æ•™ç¨‹ç®€ä»‹">(æ–½å·¥ä¸­) mapbox-glæ•™ç¨‹(9):ä½¿ç”¨webglæ¥å£æ‰©å±•å±•ç°æ•ˆæœ</a></p>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapbox-glæ•™ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaè¯»å–arcgisçš„gdbæ–‡ä»¶</title>
    <link href="/2020/11/05/2020-11-5-java-read-gdb/"/>
    <url>/2020/11/05/2020-11-5-java-read-gdb/</url>
    
    <content type="html"><![CDATA[<p>gdb,æ˜¯arcgisé‡è¦çš„æ•°æ®æ ¼å¼ä¹‹ä¸€ï¼Œå®ƒæŠŠçŸ¢é‡æ•°æ®æŒ‰ä»¥ä¸‹å±‚çº§ç»“æ„å­˜ä¸ºæœ¬åœ°æ–‡ä»¶</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ada">å›¾å±‚<br><span class="hljs-comment">-- è¦ç´ </span><br><span class="hljs-comment">---- å±æ€§</span><br><span class="hljs-comment">---- å½¢çŠ¶</span><br><span class="hljs-comment">---- æ ·å¼</span><br></code></pre></td></tr></table></figure><p>gdalæä¾›äº†å‡½æ•°å…è®¸æˆ‘ä»¬è¯»å–gdbï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡jniè°ƒç”¨gdalæ¥å†javaä¸­è¯»å–gdal</p><h1 id="1ã€é…ç½®gdalç¯å¢ƒ"><a href="#1ã€é…ç½®gdalç¯å¢ƒ" class="headerlink" title="1ã€é…ç½®gdalç¯å¢ƒ"></a>1ã€é…ç½®gdalç¯å¢ƒ</h1><p>liunxä¸‹æŒ‰ç…§gdaléœ€è¦ç¼–è¯‘ï¼Œè€Œwindowsä¸‹å°±æ¯”è¾ƒç®€å•äº†ï¼Œä¸‹è½½ç¼–è¯‘å¥½çš„dllæ–‡ä»¶ï¼Œç„¶åç¯å¢ƒå˜é‡pathé‡ŒåŠ å…¥dllç›®å½•å³å¯</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">é“¾æ¥ï¼šhttps:<span class="hljs-regexp">//</span>pan.baidu.com<span class="hljs-regexp">/s/</span><span class="hljs-number">1</span>kH3djGQsow-llQiy82068g <br>æå–ç ï¼šuuwn<br></code></pre></td></tr></table></figure><h1 id="2ã€å»ºä¸€ä¸ªmavenå·¥ç¨‹"><a href="#2ã€å»ºä¸€ä¸ªmavenå·¥ç¨‹" class="headerlink" title="2ã€å»ºä¸€ä¸ªmavenå·¥ç¨‹"></a>2ã€å»ºä¸€ä¸ªmavenå·¥ç¨‹</h1><p>å‰é¢ä¸‹è½½çš„é‚£ä¸ªåŒ…é‡Œçš„libæ–‡ä»¶å¤¹æ‹·åˆ°å·¥ç¨‹ä¸­ï¼Œç„¶åmavené‡Œæ·»åŠ gdalçš„ä¾èµ–:</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.gdal<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>gdal<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>system<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;systemPath&gt;$</span></span><span class="hljs-template-variable">&#123;project.basedir&#125;</span><span class="xml"><span class="hljs-comment">/lib/gdal-centos7x64.jar&lt;/systemPath&gt;--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">systemPath</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;project.basedir&#125;</span><span class="xml">/lib/gdal-win64.jar<span class="hljs-tag">&lt;/<span class="hljs-name">systemPath</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h1 id="3ã€å†™ä»£ç "><a href="#3ã€å†™ä»£ç " class="headerlink" title="3ã€å†™ä»£ç "></a>3ã€å†™ä»£ç </h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> org.gdal.gdal.gdal;<br><span class="hljs-keyword">import</span> org.gdal.ogr.*;<br><br><span class="hljs-keyword">import</span> java.sql.Date;<br><span class="hljs-keyword">import</span> java.sql.Time;<br><span class="hljs-keyword">import</span> java.sql.Timestamp;<br><span class="hljs-keyword">import</span> java.time.LocalDate;<br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><span class="hljs-keyword">import</span> java.time.LocalTime;<br><br><span class="hljs-comment">/**<br> * gdalè¯»å–gdbç¤ºä¾‹<br> * <span class="hljs-doctag">@author</span> liuyu<br> * <span class="hljs-doctag">@date</span> 2020/11/5<br> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> &#123;<br>        gdal.AllRegister();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Driver driver = ogr.GetDriverByName(<span class="hljs-string">"OpenFileGDB"</span>);<br>        DataSource dataSource = driver.Open(<span class="hljs-string">"D:\\data\\äº‘å—çœçŸ¢é‡åœ°å›¾gdb\\äº‘å—çœåœ°å›¾ç»¼åˆæˆæœ.gdb"</span>, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; dataSource.GetLayerCount(); i++) &#123;<br>            <span class="hljs-comment">//è·å–å›¾å±‚</span><br>            Layer layer = dataSource.GetLayer(i);<br>            System.out.println(i + <span class="hljs-string">"\t"</span> + layer.GetName());<br>            <span class="hljs-keyword">do</span> &#123;<span class="hljs-comment">//è·å–å›¾å±‚ä¸‹çš„è¦ç´ </span><br>                Feature feature = layer.GetNextFeature();<br>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == feature) &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">//è·å–æ ·å¼ï¼Œè¿™é‡Œæ˜¯ç©ºï¼Œå¾…ç¡®å®š</span><br>                System.out.println(feature.GetStyleString());<br>                <span class="hljs-comment">//è·å–geometry</span><br>                System.out.println(feature.GetGeometryRef().ExportToWkt());<span class="hljs-comment">//ä¹Ÿå¯ä»¥ExportToWkb() gmlç­‰ç­‰</span><br>                <span class="hljs-comment">//è·å–å±æ€§</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>; p &lt; feature.GetFieldCount(); p++) &#123;<br>                    System.out.println(feature.GetFieldDefnRef(p).GetName()<br>                            + <span class="hljs-string">"\t"</span> +<br>                            getProperty(feature, p));<br>                &#125;<br>                System.out.println(<span class="hljs-string">"---------"</span>);<br>            &#125; <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title">getProperty</span><span class="hljs-params">(Feature feature, <span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> type = feature.GetFieldType(index);<br>        PropertyGetter propertyGetter;<br>        <span class="hljs-keyword">if</span> (type &lt; <span class="hljs-number">0</span> || type &gt;= propertyGetters.length) &#123;<br>            propertyGetter = stringPropertyGetter;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            propertyGetter = propertyGetters[type];<br>        &#125;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> propertyGetter.get(feature, index);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>     * å±æ€§è·å–å™¨<br>     */</span><br>    <span class="hljs-meta">@FunctionalInterface</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PropertyGetter</span> </span>&#123;<br>        <span class="hljs-function">Object <span class="hljs-title">get</span><span class="hljs-params">(Feature feature, <span class="hljs-keyword">int</span> index)</span></span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> PropertyGetter stringPropertyGetter = (feature, index) -&gt; feature.GetFieldAsString(index);<br><br>    <span class="hljs-comment">/**<br>     * feature.GetFieldType(index)å¾—åˆ°ä¸€ä¸ªå±æ€§ç±»å‹çš„intå€¼,è¯¥å€¼å¯¹åº”å…·ä½“ç±»å‹<br>     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> PropertyGetter[] propertyGetters = <span class="hljs-keyword">new</span> PropertyGetter[]&#123;<br>            (feature, index) -&gt; feature.GetFieldAsInteger(index),<span class="hljs-comment">//0Integer</span><br>            (feature, index) -&gt; feature.GetFieldAsIntegerList(index),<span class="hljs-comment">//1IntegerList</span><br>            (feature, index) -&gt; feature.GetFieldAsDouble(index),<span class="hljs-comment">//2Real</span><br>            (feature, index) -&gt; feature.GetFieldAsDoubleList(index),<span class="hljs-comment">//3RealList</span><br>            stringPropertyGetter,<span class="hljs-comment">//4String</span><br>            (feature, index) -&gt; feature.GetFieldAsStringList(index),<span class="hljs-comment">//5StringList</span><br>            stringPropertyGetter,<span class="hljs-comment">//6(unknown)</span><br>            stringPropertyGetter,<span class="hljs-comment">//7(unknown)</span><br>            (feature, index) -&gt; feature.GetFieldAsBinary(index),<span class="hljs-comment">//8Binary</span><br>            (feature, index) -&gt; &#123;<br>                <span class="hljs-keyword">int</span>[] pnYear = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMonth = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnDay = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnHour = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMinute = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">float</span>[] pfSecond = <span class="hljs-keyword">new</span> <span class="hljs-keyword">float</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnTZFlag = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                feature.GetFieldAsDateTime(index, pnYear, pnMonth, pnDay, pnHour, pnMinute, pfSecond, pnTZFlag);<br>                Date date = Date.valueOf(LocalDate.of(pnYear[<span class="hljs-number">0</span>], pnMonth[<span class="hljs-number">0</span>], pnDay[<span class="hljs-number">0</span>]));<br>                <span class="hljs-keyword">return</span> date;<br>            &#125;,<span class="hljs-comment">//9Date</span><br>            (feature, index) -&gt; &#123;<br>                <span class="hljs-keyword">int</span>[] pnYear = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMonth = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnDay = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnHour = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMinute = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">float</span>[] pfSecond = <span class="hljs-keyword">new</span> <span class="hljs-keyword">float</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnTZFlag = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                feature.GetFieldAsDateTime(index, pnYear, pnMonth, pnDay, pnHour, pnMinute, pfSecond, pnTZFlag);<br>                <span class="hljs-keyword">float</span> fSecond = pfSecond[<span class="hljs-number">0</span>];<br>                <span class="hljs-keyword">int</span> s = (<span class="hljs-keyword">int</span>) fSecond;<br>                <span class="hljs-keyword">int</span> ns = (<span class="hljs-keyword">int</span>) (<span class="hljs-number">1000000000</span> * fSecond - s);<br>                Time time = Time.valueOf(LocalTime.of(pnHour[<span class="hljs-number">0</span>], pnMinute[<span class="hljs-number">0</span>], s, ns));<br>                <span class="hljs-keyword">return</span> time;<br>            &#125;,<span class="hljs-comment">// 10Time</span><br>            (feature, index) -&gt; &#123;<br>                <span class="hljs-keyword">int</span>[] pnYear = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMonth = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnDay = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnHour = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnMinute = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">float</span>[] pfSecond = <span class="hljs-keyword">new</span> <span class="hljs-keyword">float</span>[<span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">int</span>[] pnTZFlag = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">1</span>];<br>                feature.GetFieldAsDateTime(index, pnYear, pnMonth, pnDay, pnHour, pnMinute, pfSecond, pnTZFlag);<br>                <span class="hljs-keyword">float</span> fSecond = pfSecond[<span class="hljs-number">0</span>];<br>                <span class="hljs-keyword">int</span> s = (<span class="hljs-keyword">int</span>) fSecond;<br>                <span class="hljs-keyword">int</span> ns = (<span class="hljs-keyword">int</span>) (<span class="hljs-number">1000000000</span> * fSecond - s);<br>                LocalDateTime localDateTime = LocalDateTime.of(<br>                        LocalDate.of(pnYear[<span class="hljs-number">0</span>], pnMonth[<span class="hljs-number">0</span>], pnDay[<span class="hljs-number">0</span>]),<br>                        LocalTime.of(pnHour[<span class="hljs-number">0</span>], pnMinute[<span class="hljs-number">0</span>], s, ns)<br>                );<br>                Timestamp timestamp = Timestamp.valueOf(localDateTime);<br>                <span class="hljs-keyword">return</span> timestamp;<br>            &#125;,<span class="hljs-comment">//11DateTime</span><br>            (feature, index) -&gt; feature.GetFieldAsInteger64(index),<span class="hljs-comment">//12Integer64</span><br>            (feature, index) -&gt; feature.GetFieldAsIntegerList(index),<span class="hljs-comment">//13 Integer64List</span><br>            <span class="hljs-comment">//&gt;=14(unknown)</span><br>    &#125;;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>æœåŠ¡ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>arcgis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹²æ‰mapboxé‡Œçš„é›ªç¢§å›¾(sprite)</title>
    <link href="/2020/09/25/2020-09-25-kill-the-sprite/"/>
    <url>/2020/09/25/2020-09-25-kill-the-sprite/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯é›ªç¢§å›¾"><a href="#ä»€ä¹ˆæ˜¯é›ªç¢§å›¾" class="headerlink" title="ä»€ä¹ˆæ˜¯é›ªç¢§å›¾"></a>ä»€ä¹ˆæ˜¯é›ªç¢§å›¾</h1><p>é›ªç¢§å›¾æºäºå‰ç«¯çš„å°å›¾æ ‡å±•ç°æŠ€æœ¯ï¼Œå°†å°å›¾æ ‡å’ŒèƒŒæ™¯å›¾åƒåˆå¹¶åˆ°ä¸€å¼ å›¾ç‰‡ä¸Šï¼Œç„¶ååˆ©ç”¨cssçš„èƒŒæ™¯å®šä½æ¥æ˜¾ç¤ºéœ€è¦æ˜¾ç¤ºçš„å›¾ç‰‡éƒ¨åˆ†ã€‚<br>å¯¹äºå«æœ‰å¤§é‡å°å›¾æ ‡çš„é¡µé¢ï¼Œé›ªç¢§å›¾æŠŠå¤šä¸ªå›¾ç‰‡è¯·æ±‚åˆå¹¶æˆäº†ä¸€ä¸ªï¼Œå¤§å¹…æé«˜äº†åŠ è½½æ€§èƒ½ã€‚<br><img src="/myimgs/20200925/1.jpg" alt="é›ªç¢§å›¾"></p><p>mapboxä¸­ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼çš„æ€æƒ³ï¼šå½“æˆ‘ä»¬é…ç½®äº†å¤šä¸ªsymbolç±»å‹çš„å›¾å±‚æ—¶ï¼Œä¸ºäº†å‡å°‘å›¾æ ‡çš„è¯·æ±‚æ•°ï¼Œmapboxä¹Ÿæä¾›äº†é›ªç¢§å›¾çš„åŠ è½½æ–¹å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> map = <span class="hljs-keyword">new</span> mapboxgl.Map(&#123;<br>    <span class="hljs-attr">container</span>: <span class="hljs-string">'map'</span>,<br>    <span class="hljs-attr">style</span>: &#123;<br>        <span class="hljs-string">"version"</span>: <span class="hljs-number">8</span>,<br>        <span class="hljs-string">"sources"</span>: &#123;&#125;,<br>        <span class="hljs-string">"layers"</span>: [],<br>        <span class="hljs-string">"sprite"</span>: baseUrl + <span class="hljs-string">"/assets/sprites/mysprites"</span>,<span class="hljs-comment">//é…ç½®ä¸€ä¸ªé›ªç¢§å›¾çš„urlè·¯å¾„</span><br>    &#125;,<br>    <span class="hljs-comment">//...</span><br>&#125;);<br></code></pre></td></tr></table></figure><p>é…ç½®äº†spriteå­—æ®µåï¼Œmapboxå°±ä¼šå»åŠ è½½é›ªç¢§å›¾pngå’Œä¸€ä¸ªjsoné…ç½®ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">"icon1"</span>: &#123;<br>    <span class="hljs-attr">"x"</span>: <span class="hljs-number">324</span>,<br>    <span class="hljs-attr">"y"</span>: <span class="hljs-number">308</span>,<br>    <span class="hljs-attr">"width"</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-attr">"height"</span>: <span class="hljs-number">11</span>,<br>    <span class="hljs-attr">"pixelRatio"</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">"sdf"</span>: <span class="hljs-literal">false</span><br>  &#125;,<br>  <span class="hljs-attr">"icon2"</span>: &#123;<br>    <span class="hljs-attr">"x"</span>: <span class="hljs-number">221</span>,<br>    <span class="hljs-attr">"y"</span>: <span class="hljs-number">464</span>,<br>    <span class="hljs-attr">"width"</span>: <span class="hljs-number">15</span>,<br>    <span class="hljs-attr">"height"</span>: <span class="hljs-number">15</span>,<br>    <span class="hljs-attr">"pixelRatio"</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">"sdf"</span>: <span class="hljs-literal">false</span><br>  &#125;,<br>  <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>éšåï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å›¾å±‚ä¸­ä½¿ç”¨è¿™ä¸ªå›¾æ ‡äº†:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">map.addLayer(<br>            &#123;<br>                <span class="hljs-string">"id"</span>: <span class="hljs-string">"mylayer"</span>,<br>                <span class="hljs-string">"type"</span>: <span class="hljs-string">"symbol"</span>,<br>                <span class="hljs-string">"source"</span>: <span class="hljs-string">"mysource"</span>,<br>                <span class="hljs-string">"source-layer"</span>: <span class="hljs-string">"mylayersource"</span>,<br>                <span class="hljs-string">"layout"</span>: &#123;<br>                    <span class="hljs-string">"icon-image"</span>: <span class="hljs-string">"icon1"</span>,<br>                &#125;<br>            &#125;<br><br>)<br></code></pre></td></tr></table></figure><h1 id="ç”¨é›ªç¢§å›¾æ¥é…å›¾æ ‡çš„ç¼ºç‚¹"><a href="#ç”¨é›ªç¢§å›¾æ¥é…å›¾æ ‡çš„ç¼ºç‚¹" class="headerlink" title="ç”¨é›ªç¢§å›¾æ¥é…å›¾æ ‡çš„ç¼ºç‚¹"></a>ç”¨é›ªç¢§å›¾æ¥é…å›¾æ ‡çš„ç¼ºç‚¹</h1><p>æƒ³åœ¨é›ªç¢§å›¾ä¸Šæ”¹å›¾æ ‡å°±ä¸é‚£ä¹ˆå®¹æ˜“ï¼Œå°¤å…¶æ˜¯æˆ‘è¿™ç§å¤§è€ç²—çš„ç¨‹åºå‘˜ï¼Œè¿˜è¦ä¹°æ¯å¥¶èŒ¶å»åŠ³çƒ¦ç¾å·¥å¦¹å­å¸®å¿™ã€‚<br>å—¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å†™æ®µä»£ç å»ä¿®æ”¹å®ƒï¼Œæˆ–è€…ç›´æ¥æ‰¾ä¸€äº›ç›¸å…³çš„å¼€æºå·¥å…·æ¥è§£å†³ã€‚</p><p>ç„¶è€Œï¼ŒçŸ¢é‡ç“¦ç‰‡çš„ä¸€å¤§å–ç‚¹å°±æ˜¯ç”¨æˆ·å¯ä»¥åœ¨å‰ç«¯è‡ªç”±å®šåˆ¶æ ·å¼ï¼Œè¦å»ä¿®æ”¹å›¾ç‰‡è¿™ä¸ªæ“ä½œä¸€å®šç¨‹åº¦ä¸Šé™åˆ¶äº†çŸ¢é‡ç“¦ç‰‡æ ·å¼çš„çµæ´»æ€§ã€‚</p><p>åŒæ—¶ï¼Œç›®å‰mapboxä»…æ”¯æŒä¼ å…¥ä¸€å¼ é›ªç¢§å›¾ï¼Œå‡å¦‚ç”¨æˆ·è‡ªå·±çš„å›¾å±‚ä¹Ÿé…äº†ä¸€ä»½é›ªç¢§å›¾ï¼Œé‚£è¿˜éœ€è¦æŠŠä¸¤ä¸ªé›ªç¢§å›¾åˆèµ·æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´å›¾å±‚çš„è‡ªç”±ç»„åˆä¹Ÿå—åˆ°äº†é™åˆ¶ã€</p><h1 id="ç”¨å•ä¸ªå›¾æ ‡æ¥æ›¿ä»£é›ªç¢§å›¾"><a href="#ç”¨å•ä¸ªå›¾æ ‡æ¥æ›¿ä»£é›ªç¢§å›¾" class="headerlink" title="ç”¨å•ä¸ªå›¾æ ‡æ¥æ›¿ä»£é›ªç¢§å›¾"></a>ç”¨å•ä¸ªå›¾æ ‡æ¥æ›¿ä»£é›ªç¢§å›¾</h1><h2 id="å•ä¸ªå›¾æ ‡çš„ä½¿ç”¨"><a href="#å•ä¸ªå›¾æ ‡çš„ä½¿ç”¨" class="headerlink" title="å•ä¸ªå›¾æ ‡çš„ä½¿ç”¨"></a>å•ä¸ªå›¾æ ‡çš„ä½¿ç”¨</h2><p>åŸºäºä¸Šè¿°é—®é¢˜ï¼Œåœ¨æ›´çµæ´»çš„æ ·å¼é…ç½®çš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨å•ä¸ªå›¾æ ‡æ¯”é›ªç¢§å›¾æ•´åˆè¦æ–¹ä¾¿çš„å¤šï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> url = <span class="hljs-string">'http://xxx.png'</span><br><span class="hljs-keyword">let</span> iconId = <span class="hljs-string">'icon1'</span><br>map.loadImage(url, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, img</span>) </span>&#123;<br>            <span class="hljs-keyword">if</span> (map.hasImage(iconId)) &#123;<br>                map.updateImage(iconId, img)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                map.addImage(iconId, img)<br>            &#125;<br>            map.addLayer(&#123;<br>                                         <span class="hljs-string">"id"</span>: <span class="hljs-string">"mylayer"</span>,<br>                                         <span class="hljs-string">"type"</span>: <span class="hljs-string">"symbol"</span>,<br>                                         <span class="hljs-string">"source"</span>: <span class="hljs-string">"mysource"</span>,<br>                                         <span class="hljs-string">"source-layer"</span>: <span class="hljs-string">"mylayersource"</span>,<br>                                         <span class="hljs-string">"layout"</span>: &#123;<br>                                             <span class="hljs-string">"icon-image"</span>: iconId,<br>                                         &#125;<br>            &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>éœ€è¦æ›´æ¢/æ–°å¢å›¾æ ‡æ—¶ï¼Œåªè¦æ”¹ä¸€ä¸‹å›¾æ ‡urlä¹‹ç±»çš„ä»£ç å³å¯ã€‚</p><h2 id="è§£å†³å•ä¸ªå›¾æ ‡åŠ è½½çš„æ€§èƒ½é—®é¢˜"><a href="#è§£å†³å•ä¸ªå›¾æ ‡åŠ è½½çš„æ€§èƒ½é—®é¢˜" class="headerlink" title="è§£å†³å•ä¸ªå›¾æ ‡åŠ è½½çš„æ€§èƒ½é—®é¢˜"></a>è§£å†³å•ä¸ªå›¾æ ‡åŠ è½½çš„æ€§èƒ½é—®é¢˜</h2><p>å‰é¢æåˆ°ï¼Œä½¿ç”¨é›ªç¢§å›¾æ˜¯ä¸ºäº†å‡å°‘å›¾ç‰‡è¯·æ±‚æ•°é‡ä»è€Œæé«˜åŠ è½½æ€§èƒ½ï¼Œå½“å›¾æ ‡æ•°é‡å¾ˆå¤šæ—¶ï¼Œæˆ‘ä»¬ä¼ å¤šä¸ªurlå»è¯·æ±‚å›¾ç‰‡å°±ä¸åˆé€‚äº†ã€‚</p><p>å¹¸å¥½loadImageå‡½æ•°ä¼ å…¥çš„urlå…è®¸æ˜¯ä¸€ä¸ªbase64å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">data:image/png;base64,R0lGODlhHAAmAKIHA<span class="hljs-built_in">..</span>.<span class="hljs-attribute">f394uLiwAAAP</span>===<br></code></pre></td></tr></table></figure><p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªæœåŠ¡ï¼Œæ‰¹é‡ä¼ å…¥å›¾æ ‡idï¼Œæ‰¹é‡è¿”å›å›¾æ ‡base64å­—ç¬¦ä¸²ï¼Œä»è€Œå°†å¤šä¸ªè¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ª</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta">#è¯·æ±‚url</span><br>http:<span class="hljs-comment">//xxx/getIcons?id=icon1,icon2</span><br><br><span class="hljs-meta">#è¿”å›æ•°æ®</span><br>&#123;<br>    icon1:<span class="hljs-string">'data:image/png;base64,R0lGODlhHAAmAKIHA...f394uLiwAAAP==='</span>,<br>    icon2:<span class="hljs-string">'yH5Bâ€¦EoqQqJKT1TRk1V7S2xYJADs='</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åï¼Œå†ç¼–å†™ä¸€æ®µå¯¹åº”çš„å‰ç«¯åŠ è½½å‡½æ•°å³å¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**<br> * ä»è‡ªå®šä¹‰æœåŠ¡æ‰¹é‡åŠ è½½å›¾ç‰‡<br> * <span class="hljs-doctag">@param <span class="hljs-variable">map</span></span><br> * <span class="hljs-doctag">@param <span class="hljs-variable">ids</span></span><br> * <span class="hljs-doctag">@param <span class="hljs-variable">cb</span></span><br> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadBatch</span>(<span class="hljs-params">map, ids, cb</span>) </span>&#123;<br>    <span class="hljs-keyword">let</span> uuids = <span class="hljs-string">''</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> iconId <span class="hljs-keyword">in</span> ids) &#123;<br>        <span class="hljs-keyword">const</span> uuid = ids[iconId];<br>        uuids += uuid + <span class="hljs-string">','</span><br>    &#125;<br>    $.ajax(&#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">'POST'</span>,<br>        <span class="hljs-attr">url</span>: <span class="hljs-string">"http://xxx/getIcons"</span>,<br>        <span class="hljs-attr">data</span>: &#123;<span class="hljs-attr">ids</span>: uuids&#125;,<br>        <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>,<br>        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">json</span>) </span>&#123;<span class="hljs-comment">//è·å–æ•°æ®</span><br>            <span class="hljs-keyword">const</span> notFinds = [];<br>            <span class="hljs-keyword">const</span> urls = &#123;&#125;;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> iconId <span class="hljs-keyword">in</span> ids) &#123;<br>                <span class="hljs-keyword">const</span> uuid = ids[iconId];<br>                <span class="hljs-keyword">const</span> base64 = json[uuid]<br>                <span class="hljs-keyword">if</span> (!base64) &#123;<br>                    notFinds.push(iconId)<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    urls[iconId] = base64<br>                &#125;<br>            &#125;<br>            loadFromUrls(map, urls, cb)<br>        &#125;<br><br>    &#125;);<br>&#125;<br><br><span class="hljs-comment">/**<br> * æ‰¹é‡åŠ è½½urlå›¾ç‰‡<br> * <span class="hljs-doctag">@param <span class="hljs-variable">map</span></span><br> * <span class="hljs-doctag">@param </span>urls è¯·æ±‚urls &#123;&lt;id1&gt;:&lt;url1&gt;,&lt;id2&gt;:&lt;url2&gt;,...&#125;<br> * <span class="hljs-doctag">@param </span>cb å›è°ƒå‡½æ•° &#123;imgs:&#123;&#125;,errs:&#123;&#125;&#125;<br> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFromUrls</span>(<span class="hljs-params">map, urls, cb</span>) </span>&#123;<br>    <span class="hljs-keyword">const</span> res = &#123;<br>        <span class="hljs-attr">imgs</span>: &#123;&#125;,<br>        <span class="hljs-attr">errs</span>: &#123;&#125;<br>    &#125;<br>    <span class="hljs-keyword">let</span> num = <span class="hljs-built_in">Object</span>.keys(urls).length<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doReturn</span>(<span class="hljs-params"></span>) </span>&#123;<br>        num--;<br>        <span class="hljs-keyword">if</span> (num == <span class="hljs-number">0</span>) &#123;<br>            cb(res)<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subCb</span>(<span class="hljs-params">iconId, img</span>) </span>&#123;<br>        res.imgs[iconId] = img;<br>        doReturn();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subErrCb</span>(<span class="hljs-params">iconId, err</span>) </span>&#123;<br>        res.errs[iconId] = err;<br>        doReturn();<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> iconId <span class="hljs-keyword">in</span> urls) &#123;<br>        <span class="hljs-keyword">const</span> url = urls[iconId];<br>        loadFromUrl(map, iconId, url, subCb, subErrCb)<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**<br> * åŠ è½½url<br> * <span class="hljs-doctag">@param <span class="hljs-variable">map</span></span><br> * <span class="hljs-doctag">@param </span>iconId å›¾æ ‡id<br> * <span class="hljs-doctag">@param </span>url url å¯ä»¥æ˜¯base64url<br> * <span class="hljs-doctag">@param </span>cb åŠ è½½æˆåŠŸå›è°ƒ<br> * <span class="hljs-doctag">@param </span>errCb åŠ è½½é”™è¯¯å›è°ƒ<br> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFromUrl</span>(<span class="hljs-params">map, iconId, url, cb, errCb</span>) </span>&#123;<br>    map.loadImage(url, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, img</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (err) &#123;<br>            <span class="hljs-keyword">if</span> (errCb) &#123;<br>                errCb(iconId, err)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">throw</span> err<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (map.hasImage(iconId)) &#123;<br>            map.updateImage(iconId, img)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            map.addImage(iconId, img)<br>        &#125;<br>        cb(iconId, img)<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è™½ç„¶å½“ä¸‹çš„webå¼€å‘è®²ç©¶å‰åç«¯åˆ†ç¦»ï¼Œ<br>ä½†æ˜¯ä»é›ªç¢§å›¾çš„è¿™ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œä½œä¸ºä¸€ä¸ªgiserï¼Œåœ¨ä¸»ä¿®å‰ç«¯oråç«¯çš„ä¸€æ–¹æ—¶ï¼Œè¿˜æ˜¯è¦å¤šå»åŒæ—¶äº†è§£ä¸‹å‰åç«¯çš„çŸ¥è¯†ï¼Œæ‰èƒ½è®¾è®¡å‡ºæ›´é«˜æ•ˆã€çµæ´»çš„æ–¹æ¡ˆã€‚</p>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>neo4jåŒæ—¶ä½¿ç”¨åµŒå…¥æ¨¡å¼å’ŒæœåŠ¡æ¨¡å¼</title>
    <link href="/2019/12/27/2019-12-27-custom-neo4j1/"/>
    <url>/2019/12/27/2019-12-27-custom-neo4j1/</url>
    
    <content type="html"><![CDATA[<p>neo4j(ç¤¾åŒºç‰ˆ)æœ‰ä¸¤ç§æ¨¡å¼:åµŒå…¥æ¨¡å¼å’ŒæœåŠ¡å™¨æ¨¡å¼ï¼Œä¸‹å›¾æè¿°äº†å®ƒä»¬çš„ä½¿ç”¨åŒºåˆ«ï¼Œç®€å•æ¥è¯´ï¼ŒåµŒå…¥æ¨¡å¼å°±æ˜¯ç›´æ¥ç”¨javaä»£ç å»æ“ä½œï¼ŒæœåŠ¡å™¨æ¨¡å¼å°±æ˜¯é€šè¿‡æš´éœ²å‡ºæ¥çš„webç«¯å£ä¼ å…¥æŸ¥è¯¢è¯­å¥ç­‰è¿›è¡Œæ“ä½œã€‚<br><img src="/myimgs/20191227/1.jpg" alt="åµŒå…¥æ¨¡å¼ä¸æœåŠ¡å™¨æ¨¡å¼å¯¹æ¯”"></p><p>ä¸¤ç§æ¨¡å¼å“ªç§æ›´ä¼˜ï¼Ÿç½‘ä¸Šæœ‰å¤ªå¤šçš„å¸–å­è®¨è®ºè¿™ä¸ªã€‚å¯æ˜¯ï¼Œæ¯•ç«Ÿåªæœ‰å°å­©å­æ‰åšé€‰æ‹©é¢˜ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸é€‰æ‹©å…¨éƒ½è¦å‘¢O(âˆ©_âˆ©)O</p><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç </p><p>1ã€å¼•å…¥mavenä¾èµ–:</p><pre><code>        &lt;dependency&gt;            &lt;groupId&gt;org.neo4j&lt;/groupId&gt;            &lt;artifactId&gt;neo4j&lt;/artifactId&gt;            &lt;version&gt;3.4.9&lt;/version&gt;        &lt;/dependency&gt;        &lt;dependency&gt;            &lt;groupId&gt;org.neo4j.app&lt;/groupId&gt;            &lt;artifactId&gt;neo4j-server&lt;/artifactId&gt;            &lt;version&gt;3.4.9&lt;/version&gt;        &lt;/dependency&gt;</code></pre><p>2ã€æ‹·è´ä¸€ä¸ªneo4j.confæ–‡ä»¶ï¼ŒæŒ‰å®˜æ–¹æ–‡æ¡£è¿›è¡Œè‡ªå·±éœ€è¦çš„é…ç½®ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯æ­¤å¤„:</p><pre><code>#æ•°æ®æ–‡ä»¶å­˜æ”¾ä½ç½®dbms.directories.data=D:/data/test</code></pre><p>3ã€ç¼–å†™åˆå§‹åŒ–ä»£ç </p><pre><code>    private static final ServerBootstrapper serverBootstrapper;    private static final String dbPath;    private static final GraphDatabaseService graphDb;    ...        //è¯»neo4j.confçš„é…ç½®        Properties p = new Properties();        try {            p.load(ResourcesReader.readStream(Neo4jDbManager.class, &quot;neo4j.conf&quot;));        } catch (IOException e) {            throw new RuntimeException(e);        }        dbPath = p.getProperty(&quot;dbms.directories.data&quot;);        File storeDir = new File(dbPath);        serverBootstrapper = new CommunityBootstrapper();        String cfgFilePath = ResourcesReader.getClassRootPath(Neo4jDbManager.class) +                &quot;/neo4j.conf&quot;;        //ç¤¾åŒºç‰ˆçš„bugï¼Œéƒ¨åˆ†å±æ€§æ— æ³•ç›´æ¥ä»é…ç½®æ–‡ä»¶å†™å…¥(ä¾‹å¦‚7474ç«¯å£å·)ï¼Œæ‰‹åŠ¨è¦†ç›–ä¸€ä¸‹        Optional&lt;File&gt; cfgFile = Optional.of(new File(cfgFilePath));        Set&lt;String&gt;  cfgKeys = p.stringPropertyNames();        Map&lt;String, String&gt; configOverrides = new HashMap&lt;&gt;(cfgKeys.size());        for (String cfgKey : cfgKeys) {//æŠŠæ‰€æœ‰é…ç½®éƒ½è¯»åˆ°mapé‡Œï¼Œè§£å†³é»˜è®¤ç«¯å£æ— æ³•ä¿®æ”¹çš„é—®é¢˜            configOverrides.put(cfgKey, p.getProperty(cfgKey));        }        //å¯åŠ¨æœåŠ¡ç«¯æ¨¡å¼        serverBootstrapper.start(storeDir, cfgFile, configOverrides);        NeoServer neoServer = serverBootstrapper.getServer();        //è·å–å†…åµŒæ¨¡å¼dbå¯¹è±¡        graphDb = neoServer.getDatabase().getGraph();</code></pre><p>å…¶ä¸­ï¼ŒResourcesReaderæ˜¯æˆ‘è‡ªå·±å†™çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œè´Ÿè´£ä»ç›¸å¯¹è·¯å¾„è¯»å–é…ç½®æ–‡ä»¶ï¼Œè¦ç”¨çš„è¯éœ€è¦å¼•å…¥è¿™ä¸ªmavenï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ¥æ›¿æ¢å®ƒ~</p><pre><code>        &lt;dependency&gt;            &lt;groupId&gt;org.wowtools&lt;/groupId&gt;            &lt;artifactId&gt;catframe-common&lt;/artifactId&gt;            &lt;version&gt;1.4.2&lt;/version&gt;        &lt;/dependency&gt;</code></pre><p>4ã€ä½¿ç”¨æœåŠ¡ç«¯æ¨¡å¼å’Œå†…åµŒæ¨¡å¼<br>å½“åˆå§‹åŒ–å®Œæˆåï¼ŒæœåŠ¡æ¨¡å¼å·²ç»åœ¨neo4j.confé…ç½®çš„ç«¯å£å¯åŠ¨äº†ï¼Œä½ å¯ä»¥åœ¨localhost:7474ï¼ˆé»˜è®¤ç«¯å£æ˜¯è¿™ä¸ªï¼‰è¿™ä¸ªå¯è§†åŒ–ç•Œé¢æ‰“å¼€çœ‹åˆ°ã€‚</p><p>è‡³äºå†…åµŒæ¨¡å¼ï¼Œå› ä¸ºå‰é¢æˆ‘ä»¬å·²ç»æ‹¿åˆ°dbå¯¹è±¡äº†ï¼Œå¯ä»¥ä»»æ„åˆ©ç”¨java apiå»æ“ä½œäº†ï¼Œæ¯”å¦‚:</p><pre><code>        Transaction tx = graphDb.beginTx();//è®°å¾—èµ·äº‹åŠ¡å’Œå…³é—­äº‹åŠ¡        try {            graphDb.findNodes(Label.label(&quot;xxx&quot;),&quot;name&quot;,&quot;å°æ˜&quot;).forEachRemaining((node)-&gt;{                System.out.println(node.getProperty(&quot;age&quot;));            });        } finally {            tx.close();        }</code></pre><p>å¥½äº†ï¼ŒåŒæ—¶äº«å—å†…åµŒæ¨¡å¼çš„é«˜æ€§èƒ½å’ŒæœåŠ¡ç«¯æ¨¡å¼çš„å¿«æ·å§~<br>ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•æŠŠjavaæ–¹æ³•æš´éœ²æˆè‡ªå®šä¹‰å‡½æ•°åœ¨æœåŠ¡ç«¯æ¨¡å¼è°ƒç”¨ï¼Œè®©ä½ å°†äºŒè€…ç»“åˆåº”ç”¨çš„æ›´å¾—å¿ƒåº”æ‰‹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>neo4j</category>
      
    </categories>
    
    
    <tags>
      
      <tag>neo4jæ‰©å±•å¼€å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>neo4jè‡ªå®šä¹‰callå‡½æ•°</title>
    <link href="/2019/12/27/2019-12-27-custom-neo4j2/"/>
    <url>/2019/12/27/2019-12-27-custom-neo4j2/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šä¸€å°èŠ‚ä¸­(<a href="http://blog.wowtools.org/2019/12/27/2019-12-27-custom-neo4j1/">http://blog.wowtools.org/2019/12/27/2019-12-27-custom-neo4j1/</a>)<br>ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åŒæ—¶ä½¿ç”¨åµŒå…¥æ¨¡å¼å’ŒæœåŠ¡æ¨¡å¼ã€‚æœ¬å°èŠ‚å°†å­¦ä¹ å¦‚ä½•æ‰©å±•è‡ªå®šä¹‰çš„callå‡½æ•°ï¼Œä»¥æ»¡è¶³è‡ªå®šä¹‰æŸ¥è¯¢éœ€æ±‚ã€‚æœ¬å°èŠ‚çš„ä»£ç åŸºäºä¸Šä¸€å°èŠ‚ï¼Œæ‰€ä»¥ä½ å¯èƒ½è¦å…ˆæŠŠä¸Šä¸€èŠ‚ä¸­çš„ç¤ºä¾‹å…ˆå†™å‡ºæ¥å¹¶è¿è¡Œèµ·æ¥ã€‚</p><h1 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h1><p>å…ˆçœ‹æ•ˆæœå›¾ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•°test.helloï¼Œä¼ å…¥ä¸€ä¸ªnameå‚æ•°,åœ¨åå°æ‹¼æ¥å­—ç¬¦ä¸²å¹¶è¿”å›ä¸¤æ¡æµ‹è¯•æ•°æ®ã€‚<br>æˆ‘ä»¬æ‰§è¡Œå¦‚ä¸‹æŸ¥è¯¢è¯­å¥åï¼Œå¾—åˆ°å¯¹åº”çš„ç»“æœå¦‚ä¸‹ï¼š<br>call test.hello(â€˜worldâ€™)<br><img src="/myimgs/20191227/2.jpg" alt="è‡ªå®šä¹‰å‡½æ•°æŸ¥è¯¢æ•ˆæœ"></p><p>å…·ä½“å®ç°æ­¥éª¤æ˜¯è¿™æ ·çš„:</p><h2 id="ç¼–å†™Procedure"><a href="#ç¼–å†™Procedure" class="headerlink" title="ç¼–å†™Procedure"></a>ç¼–å†™Procedure</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªProcedureç±»ï¼Œç¼–å†™è‡ªå®šä¹‰å‡½æ•°ï¼Œå¹¶é€šè¿‡æ³¨è§£æš´éœ²å‡ºæ¥:</p><pre><code>import org.neo4j.graphdb.GraphDatabaseService;import org.neo4j.procedure.Context;import org.neo4j.procedure.Description;import org.neo4j.procedure.Name;import org.neo4j.procedure.Procedure;import java.util.stream.Stream;/** * è‡ªå®šä¹‰callå‡½æ•° * @author liuyu * @date 2019/12/30 */public class TestProcedures {    @Context    public GraphDatabaseService db;    /**     * è¦è¿”å›çš„è‡ªå®šä¹‰å¯¹è±¡     */    public static class HelloResult {        public final String name;        public final Long num;        public HelloResult(String name, Long num) {            this.name = name;            this.num = num;        }    }    @Procedure(&quot;test.hello&quot;)    @Description(&quot;hello worldæµ‹è¯•&quot;)    public Stream&lt;HelloResult&gt; helloWorld(@Name(&quot;name&quot;) String name) {        return Stream.of(new HelloResult(name + &quot;-1&quot;, 123L), new HelloResult(name + &quot;-2&quot;, 456L));    }}</code></pre><p>å…¶ä¸­ï¼Œ<code>HelloResult</code>ç±»å®šä¹‰äº†æˆ‘ä»¬è¿”å›çš„åˆ—çš„ç±»å‹ã€‚<br>æ–¹æ³•helloWorldä¼ å…¥nameå‚æ•°ï¼Œæ‹¼æ¥äº†ä¸¤ä¸ªHelloResultå¯¹è±¡åï¼Œä»¥Streamå°è£…å¹¶è¿”å›ã€‚<br>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡@Procedure(â€œtest.helloâ€)æ³¨è§£ï¼Œå°†æ–¹æ³•helloWorldæ˜ å°„åˆ°test.helloå‡½æ•°ä¸Šã€‚</p><h2 id="æ³¨å†ŒProcedure"><a href="#æ³¨å†ŒProcedure" class="headerlink" title="æ³¨å†ŒProcedure"></a>æ³¨å†ŒProcedure</h2><p>å†æŠŠProcedureç±»æ³¨å†Œç»™dbå°±è¡Œäº†~</p><pre><code>    /**     * è‡ªå®šä¹‰å‡½æ•°æ³¨å†Œç±»     * @param db     * @param procedure     * @throws KernelException     */    public static void registerProceduresAndFunctions(GraphDatabaseService db, Class&lt;?&gt; procedure) throws KernelException {        Procedures procedures = ((GraphDatabaseAPI) db).getDependencyResolver().resolveDependency(Procedures.class);        procedures.registerProcedure(procedure);        procedures.registerFunction(procedure);    }        //...æ¥ä¸Šä¸€å°èŠ‚çš„ä»£ç         graphDb = neoServer.getDatabase().getGraph();        try {//å°†TestProceduresæ³¨å†Œè¿›æ¥ï¼Œæ‰€æœ‰@Procedureæ³¨è§£è¿‡çš„æ–¹æ³•éƒ½ä¼šè¢«æ³¨å†Œ            registerProceduresAndFunctions(graphDb, TestProcedures.class);        } catch (KernelException e) {            e.printStackTrace();        }</code></pre><h1 id="æœªå®Œå¾…ç»­å†…å®¹"><a href="#æœªå®Œå¾…ç»­å†…å®¹" class="headerlink" title="æœªå®Œå¾…ç»­å†…å®¹"></a>æœªå®Œå¾…ç»­å†…å®¹</h1><p>1ã€HelloResulté‡Œåªæ”¯æŒä¸€äº›ç‰¹å®šç±»å‹çš„å±æ€§ï¼Œå‡å¦‚æˆ‘ä»¬æŠŠnumæ”¹æˆintå‹çš„ï¼Œæ³¨å†Œæ—¶ä¼šæŠ¥å¼‚å¸¸:</p><pre><code>org.neo4j.internal.kernel.api.exceptions.ProcedureException: Field `num` in record `HelloResult` cannot be converted to a Neo4j type: Don&#39;t know how to map `int` to the Neo4j Type System.Please refer to to the documentation for full details.For your reference, known types are: [boolean, byte[], double, java.lang.Boolean, java.lang.Double, java.lang.Long, java.lang.Number,...</code></pre><p>å¦‚æœéœ€è¦è‡ªå®šä¹‰ç±»å‹ï¼Œåˆ™éœ€è¦è‡ªè¡Œå®ç°</p><p>2ã€å¦‚æœéœ€è¦æŸ¥è¯¢å›¾åº“å¹¶è¿”å›nodeå¯¹è±¡ï¼Œéœ€è¦ä¿®æ”¹æ³¨è§£ä¸º</p><pre><code>    @Procedure(        value = &quot;test.hello&quot;,        mode = Mode.WRITE    )</code></pre><p>å¹¶ä½œå¯¹åº”çš„ä»£ç ä¿®æ”¹ã€‚</p><p>è¿™äº›å†…å®¹å°†åœ¨åç»­ç« èŠ‚ä¸­è¯´æ˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>neo4j</category>
      
    </categories>
    
    
    <tags>
      
      <tag>neo4jæ‰©å±•å¼€å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dojoæŠ¥é”™Uncaught Error: irrationalPathåŸå› åŠè§£å†³</title>
    <link href="/2018/06/07/2018-06-07-Uncaught-Error-irrationalPath/"/>
    <url>/2018/06/07/2018-06-07-Uncaught-Error-irrationalPath/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å†™äº†ä¸€å †amdé£æ ¼çš„jsåº“ä¾›å…¶ä»–åŒäº‹è°ƒç”¨ï¼Œæœ‰åŒäº‹åæ˜ è¯´ç”¨dojo.jsè°ƒçš„æ—¶å€™ä¼šæŠ¥è¿™ä¸ªé”™:</p><pre><code>init.js:4 Uncaught Error: irrationalPath    at s (init.js:4)    at Ea (init.js:13)    at Ta (init.js:14)    at Ba (init.js:15)    at hb (init.js:21)    at init.js:21    at c (init.js:4)    at gb (init.js:21)    at d (init.js:20)    at HTMLScriptElement.&lt;anonymous&gt; (init.js:23)</code></pre><p>æ’æŸ¥äº†å¥½ä¹…ï¼Œç»ˆäºæ‰¾åˆ°äº†åŸå› ï¼Œä¸€å¥è¯è§£é‡Šå°±æ˜¯../ä¸èƒ½è°ƒç”¨é…ç½®æ ¹è·¯å¾„ä»¥ä¸Šçš„å†…å®¹ã€‚</p><p>è¯¦ç»†è¿˜åŸä¸€ä¸‹å‡ºé”™è¿‡ç¨‹ï¼Œæˆ‘æä¾›çš„jsåº“è·¯å¾„å¦‚ä¸‹</p><pre><code>xxx.com/    root/        a/            a1.js        b/            b1.js</code></pre><p>a1.jså¼•ç”¨äº†b1.js:</p><pre><code>define([&#39;../b/b1&#39;], function (b1) {    b1.xxx()</code></pre><p>åŒäº‹æ˜¯è¿™æ ·è°ƒç”¨çš„</p><pre><code>var dojoConfig = {    parseOnLoad: true,    packages: [        {            &quot;name&quot;: &quot;ext&quot;,            &quot;location&quot;: &quot;xxx.com/root/a&quot;        }    ]};require([        &quot;ext/a1&quot;    ],    function (a1) {        a1.ooxx();    });</code></pre><p>å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œdojoåªå…è®¸è°ƒç”¨æ ¹è·¯å¾„(xxx.com/root/a)ä¸‹çš„èµ„æº,a.jsä¸­é€šè¿‡../å»å¼•ç”¨xxx.com/root/b/b.jsï¼Œæ‰€ä»¥å°±å‡ºé”™äº†ã€‚</p><p>æ­£ç¡®åœ°å§¿åŠ¿åº”è¯¥æ˜¯è¿™æ ·:</p><pre><code>var dojoConfig = {    parseOnLoad: true,    packages: [        {            &quot;name&quot;: &quot;ext&quot;,            &quot;location&quot;: &quot;xxx.com/root&quot;        }    ]};require([        &quot;ext/a/a1&quot;    ],    function (a1) {        a1.ooxx();    });</code></pre><p>å®Œo(<em>ï¿£ï¸¶ï¿£</em>)o</p>]]></content>
    
    
    <categories>
      
      <category>å¥‡è‘©é—®é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>dojo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>centos 7å®‰è£…gdal</title>
    <link href="/2018/05/18/2018-05-18-centos7-install-gdal/"/>
    <url>/2018/05/18/2018-05-18-centos7-install-gdal/</url>
    
    <content type="html"><![CDATA[<p>gdalæ“ä½œtiffçš„æ€§èƒ½ï¼Œè¦æ¯”geotoolså¿«å¾ˆå¤šã€‚<br>æƒ³è¦åœ¨javaä¸­ä½¿ç”¨gdalï¼Œwindowså¯ä»¥ç›´æ¥ä¸‹è½½åˆ°ç¼–è¯‘å¥½çš„dllæ–‡ä»¶(<a href="http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries" target="_blank" rel="noopener">ç‚¹è¿™é‡Œä¸‹è½½</a>)ï¼Œå¹¶æŠŠå­˜æ”¾dllçš„æ–‡ä»¶å¤¹é…ç½®åˆ°pathç¯å¢ƒå˜é‡é‡Œå³å¯ï¼Œæœ‰æ—¶éœ€è¦é‡å¯ä¸€ä¸‹ideæ‰èƒ½è¯†åˆ«åˆ°<br>centosä¸‹éœ€è¦è‡ªå·±é…ç½®ç¯å¢ƒå’Œç¼–è¯‘<br>ä¸‹é¢ä»¥centos7ä¸Šå®‰è£…2.2.3ç‰ˆæœ¬çš„gdalä¸ºä¾‹ï¼Œä»‹ç»æ•´ä¸ªå®‰è£…è¿‡ç¨‹</p><p><em>å‚è€ƒèµ„æ–™<br><a href="https://www.cnblogs.com/gnool/p/7277474.html" target="_blank" rel="noopener">https://www.cnblogs.com/gnool/p/7277474.html</a><br><a href="https://blog.csdn.net/hqfgiser/article/details/78710856" target="_blank" rel="noopener">https://blog.csdn.net/hqfgiser/article/details/78710856</a></em></p><p>é¦–å…ˆï¼Œéœ€è¦ä¸‹è½½ä»¥ä¸‹æ–‡ä»¶ï¼Œæ–¹ä¾¿èµ·è§ï¼Œå·²å…¨éƒ¨ä¸Šä¼ è‡³ç½‘ç›˜:<a href="https://pan.baidu.com/s/1ulNu3QqUKMYUpsbnrIfo0w" target="_blank" rel="noopener">gdal_all_files</a></p><pre><code>gdal223.zipgeos-3.6.2.tar.bz2hdf-4.2.13.tar.gzhdf5-1.10.1.tar.gzjpegsrc.v9b.tar.gznetcdf-c-4.4.1.1.tar.gzproj-4.9.3.tar.gzswig-3.0.12.tar.gz</code></pre><h1 id="å®‰è£…gdal"><a href="#å®‰è£…gdal" class="headerlink" title="å®‰è£…gdal"></a>å®‰è£…gdal</h1><h2 id="1-åˆ‡æ¢åˆ°rootç”¨æˆ·"><a href="#1-åˆ‡æ¢åˆ°rootç”¨æˆ·" class="headerlink" title="1.åˆ‡æ¢åˆ°rootç”¨æˆ·"></a>1.åˆ‡æ¢åˆ°rootç”¨æˆ·</h2><p>su - root</p><h2 id="2-å®‰è£…ä¾èµ–ç¯å¢ƒ"><a href="#2-å®‰è£…ä¾èµ–ç¯å¢ƒ" class="headerlink" title="2.å®‰è£…ä¾èµ–ç¯å¢ƒ"></a>2.å®‰è£…ä¾èµ–ç¯å¢ƒ</h2><p>yum  -y  groupinstall â€œDevelopment toolsâ€   #è¿™æ­¥ä¸æˆåŠŸè²Œä¼¼ä¹Ÿæ²¡é—®é¢˜-_-</p><p>yum -y install zlib-devel</p><h2 id="3-åˆ†åˆ«å®‰è£…ä¸Šè¿°å®‰è£…åŒ…å¦‚ä¸‹ï¼š"><a href="#3-åˆ†åˆ«å®‰è£…ä¸Šè¿°å®‰è£…åŒ…å¦‚ä¸‹ï¼š" class="headerlink" title="3.åˆ†åˆ«å®‰è£…ä¸Šè¿°å®‰è£…åŒ…å¦‚ä¸‹ï¼š"></a>3.åˆ†åˆ«å®‰è£…ä¸Šè¿°å®‰è£…åŒ…å¦‚ä¸‹ï¼š</h2><h3 id="proj"><a href="#proj" class="headerlink" title="proj"></a>proj</h3><pre><code>tar -zxvf proj-4.9.3.tar.gzcd proj-4.9.3./configuremakemake installcd ..</code></pre><p>proj â€”help æ£€éªŒå®‰è£…</p><h3 id="geos"><a href="#geos" class="headerlink" title="geos"></a>geos</h3><pre><code>tar -zxvf geos-3.6.2.tar.gzcd geos-3.6.2./configuremakemake installldconfigcd ..</code></pre><h3 id="jpeg"><a href="#jpeg" class="headerlink" title="jpeg"></a>jpeg</h3><pre><code>tar -zxf jpegsrc.v9b.tar.gzcd jpeg-9b/./configure --prefix=/opt/jpegmake make installcd ..</code></pre><h3 id="hdf5"><a href="#hdf5" class="headerlink" title="hdf5"></a>hdf5</h3><pre><code>tar -zxf hdf5-1.10.1.tar.gzcd hdf5-1.10.1export F9X=ifort./configure --prefix=/opt/hdf5 --with-hdf4=/opt/hdf4 --with-jpeg=/opt/jpeg --enable-java --enable-cxxmake make installcd ..</code></pre><pre><code>tar -zxf hdf-4.2.13.tar.gzcd hdf-4.2.13./configure --prefix=/opt/hdf4 --enable-netcdf --enable-jpeg --with-jpeg=/opt/jpeg --enable-hdf5 --with-hdf5=/opt/hdf5 --enable-shared --disable-fortran --enable-javamakemake installcd ..</code></pre><h3 id="netcdf"><a href="#netcdf" class="headerlink" title="netcdf"></a>netcdf</h3><pre><code>tar -zxf netcdf-4.4.1.tar.gzcd netcdf-4.4.1CPPFLAGS=&quot;-l/opt/hdf4/include -l/opt/hdf5/include -l/opt/jpeg/include&quot;LDFLAGS=&quot;-l/opt/hdf4/lib -l/opt/hdf5/lib -l/opt/jpeg/lib&quot;./configure --prefix=/opt/netcdf --enable-hdf5 --with-hdf5=/opt/hdf5 --enable-hdf4 --with-hdf4=/opt/hdf4 --enable-jpeg --with-jpeg=/opt/jpeg --disable-netcdf-4makemake installcd ..</code></pre><h4 id="gdal"><a href="#gdal" class="headerlink" title="gdal"></a>gdal</h4><pre><code>unzip gdal233.zipcd gdal-2.2.3./configure --prefix=/opt/gdal --enable-netcdf --with-netcdf=/opt/netcdf --enable-hdf5 --with-hdf5=/opt/hdf5 --enable-hdf4 --with-hdf4=/opt/hdf4makemake installcd ..</code></pre><p>gdalinfo éªŒè¯ä¸€ä¸‹</p><h3 id="swig"><a href="#swig" class="headerlink" title="swig"></a>swig</h3><p>yum install pcre<br>yum install pcre-devel</p><pre><code>tar -zxf swig-3.0.12.tar.gzcd swig-3.0.12./configuremakemake install</code></pre><p>æ£€éªŒå®‰è£…swig -help</p><h2 id="4-ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#4-ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="4.ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>4.ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><p>vi  /etc/profile<br>åŠ å…¥</p><pre><code>export PATH=${PATH}:/opt/hdf4/include:/opt/hdf4/bin:/opt/hdf5/include:/opt/hdf5/bin:/opt/netcdf/include:/opt/netcdf/bin:/opt/gdal/include:/opt/gdal/binexport LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/opt/hdf4/lib:/opt/hdf5/lib:/opt/netcdf/lib:/opt/gdal/lib</code></pre><p>source  /etc/profile</p><h1 id="ç¼–è¯‘gdal-java"><a href="#ç¼–è¯‘gdal-java" class="headerlink" title="ç¼–è¯‘gdal-java"></a>ç¼–è¯‘gdal-java</h1><h2 id="1ã€å®‰è£…jdk"><a href="#1ã€å®‰è£…jdk" class="headerlink" title="1ã€å®‰è£…jdk"></a>1ã€å®‰è£…jdk</h2><p>ç•¥</p><h2 id="2ã€ç¼–è¯‘jarå’Œjniæ–‡ä»¶"><a href="#2ã€ç¼–è¯‘jarå’Œjniæ–‡ä»¶" class="headerlink" title="2ã€ç¼–è¯‘jarå’Œjniæ–‡ä»¶"></a>2ã€ç¼–è¯‘jarå’Œjniæ–‡ä»¶</h2><p>è¿›å…¥<gdal-dir>\swig\javaä¿®æ”¹java.optæ–‡ä»¶ï¼ŒæŒ‡å®šjdkçš„è·¯å¾„ï¼Œ<gdal-dir>ä¸ºgdalæ–‡ä»¶å¤¹ã€‚å†…å®¹å¦‚ä¸‹ï¼š </p><pre><code>JAVA_HOME = /opt/jdk1.8JAVADOC=$(JAVA_HOME)/bin/javadoc JAVAC=$(JAVA_HOME)/bin/javac JAVA=$(JAVA_HOME)/bin/java JAR=$(JAVA_HOME)/bin/jar JAVA_INCLUDE=-I$(JAVA_HOME)/include -I$(JAVA_HOME)/include/linux </code></pre><p>ç¼–è¯‘éœ€è¦antæ”¯æŒï¼Œæ‰€ä»¥:</p><pre><code>yum install ant</code></pre><p>ç¼–è¯‘,å¹¶å°†soæ–‡ä»¶æ‹·è´å‡ºæ¥</p><pre><code>cd &lt;gdal&gt;/swig/java/makecd .libs/cp *.so /usr/local/gdalso/</code></pre><p>åŒæ—¶ï¼Œç›®å½•ä¸‹ä¼šç”Ÿæˆgdal.jarï¼Œæ‹·è´åˆ°é¡¹ç›®ä¸­å°±å¯ä»¥ç”¨äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªjaråœ¨winå’Œlinuxä¸‹å¹¶ä¸é€šç”¨</p><p>vi ~/.bashrc ,åŠ ä¸Šç¯å¢ƒå˜é‡</p><pre><code>export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/gdalso</code></pre><p>ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼Œsource ~/.bashrc</p><p>å®Œæˆäº†ï¼Œäº«å—æ€¥é€Ÿçš„æ …æ ¼æ•°æ®å¤„ç†æ€§èƒ½å§~</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²è¿ç»´</category>
      
      <category>è½¯ä»¶å®‰è£…</category>
      
    </categories>
    
    
    <tags>
      
      <tag>gdal</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>postgisç©ºé—´æ•°æ®æ ¼å¼è§£æï¼ŒåŠå¦‚ä½•ç»‘å®šå˜é‡</title>
    <link href="/2018/03/21/2018-03-21-parse-postgis-shape/"/>
    <url>/2018/03/21/2018-03-21-parse-postgis-shape/</url>
    
    <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬å¾€postgisçš„shapeå­—æ®µä¸­æ’å…¥ä¸€æ¡æ•°æ®</p><pre><code>INSERT INTO test1 (shape)VALUES (GeomFromEWKT(&#39;SRID=4326;POINT(116.39 39.9)&#39;));</code></pre><p>è¯»å‡ºæ¥çš„shapeæ˜¯è¿™æ ·çš„:</p><pre><code>0101000020E6100000295C8FC2F5185D403333333333F34340</code></pre><p>æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªwkbæ ¼å¼çš„å­—ç¬¦ä¸²å˜›</p><p>äºæ˜¯ï¼Œåœ¨javaä¸­ï¼Œæˆ‘ä»¬åªéœ€ç”¨jtsçš„WKBReaderç±»ï¼Œä¾¿å¯ç›´æ¥å°†å…¶è§£æä¸ºgeometryå¯¹è±¡</p><pre><code>WKBReader wkbReader = new WKBReader();......æ­¤å¤„ç•¥å»jdbcçš„ä¸€å †å¥—è·¯PGobject obj = (PGobject) rs.getObject(&quot;shape&quot;);byte[] bytes = WKBReader.hexToBytes(obj.getValue());Geometry geo = wkbReader.read(bytes);System.out.println(geo);</code></pre><p>æˆ‘ä»¬å‘ç°ï¼ŒpostgreSQLç”¨PGobjectæ¥æè¿°è‡ªå®šä¹‰æ•°æ®ç±»å‹ï¼Œè€Œç©ºé—´æ•°æ®çš„typeæ˜¯geometryï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç»‘å®šå˜é‡æ¥åšé¢„è§£æï¼š</p><pre><code>        double[] bbox = new double[]{                90, 20, 120, 30        };        Coordinate[] coords = new Coordinate[]{                new Coordinate(bbox[0], bbox[1]),                new Coordinate(bbox[2], bbox[1]),                new Coordinate(bbox[2], bbox[3]),                new Coordinate(bbox[0], bbox[3]),                new Coordinate(bbox[0], bbox[1]),        };        LinearRing shell = gf.createLinearRing(coords);        Geometry env = gf.createPolygon(shell);        PGobject param = new PGobject();        //sqlåŠç»‘å®šå˜é‡è¿™æ ·å†™  &quot;select * from test1 ? &amp;&amp; shape&quot;, param</code></pre>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>æœåŠ¡ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>PostgreSQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Tomcatå¯åŠ¨æŠ¥é”™ZipException: error in opening zip fileåŠè§£å†³</title>
    <link href="/2017/11/30/2017-11-30-zip-exception/"/>
    <url>/2017/11/30/2017-11-30-zip-exception/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ—©ä¸Šåˆ°å…¬å¸ï¼Œç…§ä¾‹ä»gitæ›´æ–°äº†ä¸€ä¸‹é¡¹ç›®ï¼Œç„¶åå¼€å§‹å¹²æ´»ï¼Œå‘ç°tomcatèµ·ä¸æ¥äº†ï¼ŒæŠ¥é”™å¦‚ä¸‹:</p><pre><code>java.util.zip.ZipException: error in opening zip file</code></pre><p>æ‰“å¼€zipæ–‡ä»¶å‡ºé”™ï¼Ÿï¼Ÿç„¶è€Œé¡¹ç›®é‡Œæ²¡æœ‰ä»€ä¹ˆzipæ–‡ä»¶å•Šã€‚ã€‚äºæ˜¯ï¼Œæˆ‘çŒœæƒ³ï¼Œé¡¹ç›®é‡Œï¼Œèƒ½ç”¨zipå·¥å…·æ‰“å¼€çš„ï¼Œåªæœ‰jaråŒ…äº†å§ã€‚</p><p>okï¼Œåˆ æ‰WEB-INF/libä¸‹æ‰€æœ‰çš„jarï¼Œtomcatèƒ½å¯åŠ¨äº†(å½“ç„¶ï¼Œæ­¤æ—¶é¡¹ç›®ç”±äºç¼ºå°‘ä¾èµ–çš„jaræ— æ³•æ­£å¸¸å¯åŠ¨)ã€‚</p><p>emmmmmï¼Œè¿™ä¸‹é—®é¢˜æ‰¾åˆ°äº†ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæˆ–å‡ ä¸ªjaråŒ…åæ‰äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾åˆ°åæ‰çš„jarï¼Œå¯æ˜¯é¡¹ç›®å¥½å¤§å•Šï¼Œä¸Šç™¾ä¸ªjaråŒ…æ€ä¹ˆæ’æŸ¥å‘¢ï¼Ÿå½“ç„¶æ˜¯äºŒåˆ†æ³•æŸ¥æ‰¾äº†ï¼Œæ—¶é—´å¤æ‚åº¦åªæœ‰O(logn)æ ¹æœ¬ä¸è™šå¥½ä¹ˆ2333 :dog: ã€‚é€šä¿—ç‚¹è¯´å°±æ˜¯å…ˆåˆ æ‰ä¸€åŠjaråŒ…ï¼Œå¦‚æœæŠ¥é”™æ‰¾ä¸åˆ°æŸä¸ªç±»ï¼Œè¯´æ˜æœ‰é—®é¢˜çš„jaråœ¨åˆ æ‰çš„é‚£ä¸€åŠjaré‡Œï¼Œç„¶åä»åˆ æ‰é‚£ä¸€åŠé‡Œå†ç¼©å°èŒƒå›´ã€‚</p><p>æ•°åˆ†é’Ÿåï¼Œæ‰¾åˆ°äº†ä¸¤ä¸ªjarï¼Œæœç„¶ç”¨zipå·¥å…·æ‰“ä¸å¼€-_-!ï¼Œmavenä»“åº“é‡Œæ‰¾åˆ°å®ƒä»¬ï¼Œåˆ æ‰å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œé‡æ–°ä¸‹è½½ï¼Œé—®é¢˜è§£å†³~ :hatched_chick: </p><p>æœ€åï¼Œåæ§½ä¸€ä¸‹è¿™ä¸¤ä¸ªjaræ˜¯æ€ä¹ˆåæ‰çš„ï¼Œæˆ‘å¸å®‰å…¨ç®¡ç†è¾ƒä¸¥æ ¼ï¼Œä¸Šç½‘éœ€è¦åœ¨ç”µè„‘ä¸Šæ’ä¸€ä¸ªusb keyï¼Œæ²¡è¿™ä¸ªkeyå°±ä¼šæŠŠä½ è®¿é—®çš„ç½‘å€è½¬åˆ°ä¸€ä¸ªâ€ä½ å°šæœªé€šè¿‡å®‰å…¨æ ¡éªŒï¼Œè¯·å…ˆå·´æ‹‰å·´æ‹‰â€çš„ä¸€ä¸ªé¡µé¢ã€‚</p><p>ç„¶åæ‚²å‰§å°±è¿™æ ·å‘ç”Ÿäº†ï¼Œå¤§æ¦‚æ˜¯ä¸Šåˆæ›´æ–°å®Œä»£ç åï¼Œmavenæ­£åœ¨ä¸‹è½½ä¾èµ–æ—¶ï¼Œæˆ‘ä¸å°å¿ƒç¢°åˆ°äº†usb keyå¯¼è‡´keyæ–­å¼€äº† :eyes: ï¼Œç„¶åï¼Œä¸‹è½½ä¸‹æ¥çš„pomå°±å˜æˆè¿™æ ·äº†ï¼š<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/5f94f725-4061-48b8-bb5d-25aa1e932967" alt="233"></p><p>æ•´ä¸ªäººéƒ½ä¸å¥½äº†å•Šå–‚-_-!</p><p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Updated upstream<br>æœ¬æ–‡å‘å¸ƒäº<a href="http://blog.wowtools.org/2017/11/30/zip-exception/">http://blog.wowtools.org/2017/11/30/zip-exception</a>,è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>=======</p><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>Stashed changes</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote>]]></content>
    
    
    <categories>
      
      <category>java</category>
      
      <category>å¼‚å¸¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¥‡è‘©é—®é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>arcgis å‘å¸ƒå›¾å±‚</title>
    <link href="/2017/09/05/2017-09-05-arcgis-publishing-layer/"/>
    <url>/2017/09/05/2017-09-05-arcgis-publishing-layer/</url>
    
    <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡ç”¨arcgisäº†ï¼Œå‘å¸ƒå›¾å±‚çš„æ­¥éª¤è€æ˜¯å¿˜-_-ï¼Œç®€å•è®°å½•ä¸€ä¸‹å§</p><h1 id="åˆ¶ä½œåœ°å›¾æ–‡æ¡£"><a href="#åˆ¶ä½œåœ°å›¾æ–‡æ¡£" class="headerlink" title="åˆ¶ä½œåœ°å›¾æ–‡æ¡£"></a>åˆ¶ä½œåœ°å›¾æ–‡æ¡£</h1><h2 id="æ·»åŠ æ•°æ®"><a href="#æ·»åŠ æ•°æ®" class="headerlink" title="æ·»åŠ æ•°æ®"></a>æ·»åŠ æ•°æ®</h2><p>æ‰“å¼€ArcMapï¼Œæ–°å»ºä¸€ä¸ªåœ°å›¾æ–‡æ¡£ï¼Œå³é”®ç‚¹å‡»â€å›¾å±‚â€-&gt;â€æ·»åŠ æ•°æ®â€ï¼Œé€‰æ‹©éœ€è¦åŠ å…¥çš„æ•°æ®</p><p><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-05-arcgis-publishing-layer-1" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><p>è‹¥åŠ å…¥çš„æ˜¯tifä¹‹ç±»çš„æ–‡ä»¶ï¼Œä¸”éœ€è¦å»é™¤é»‘è¾¹ï¼Œå¯å³é”®æ­¤å›¾å±‚-&gt;å±æ€§ï¼Œå‹¾é€‰â€æ˜¾ç¤ºèƒŒæ™¯å€¼â€ï¼Œå¹¶è®¾ä¸ºæ— é¢œè‰²:</p><p><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-2" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><h2 id="ä¿®æ”¹åæ ‡ç³»"><a href="#ä¿®æ”¹åæ ‡ç³»" class="headerlink" title="ä¿®æ”¹åæ ‡ç³»"></a>ä¿®æ”¹åæ ‡ç³»</h2><p>å³é”®ç‚¹å‡»â€å›¾å±‚â€-&gt;â€å±æ€§â€ï¼Œè®¾ç½®ä¸ºéœ€è¦çš„åæ ‡ç³»<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-3" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><p>æœ€åå°†å…¶å­˜ä¸ºmxdæ–‡æ¡£ã€‚</p><h1 id="å‘å¸ƒæœåŠ¡"><a href="#å‘å¸ƒæœåŠ¡" class="headerlink" title="å‘å¸ƒæœåŠ¡"></a>å‘å¸ƒæœåŠ¡</h1><h2 id="é¢„å…ˆé…ç½®ä¸€ä¸‹arcgis-server"><a href="#é¢„å…ˆé…ç½®ä¸€ä¸‹arcgis-server" class="headerlink" title="é¢„å…ˆé…ç½®ä¸€ä¸‹arcgis server"></a>é¢„å…ˆé…ç½®ä¸€ä¸‹arcgis server</h2><p>æ‰“å¼€ArcCatalogï¼Œåœ¨å·¦ä¾§ç›®å½•æ ‘çš„â€gisæœåŠ¡å™¨â€ä¸‹é€‰æ‹©â€æ·»åŠ arcgis serverâ€ï¼Œç„¶åæ ¹æ®è‡ªå·±arcgis serverçš„è¿æ¥ä¿¡æ¯ï¼Œä¸€è·¯ä¸‹ä¸€æ­¥ï¼Œæ·»åŠ ä¸€ä¸ªserverã€‚<br>ç„¶åæ‰“å¼€arcserverçš„webæ§åˆ¶å°ï¼Œå¤§æ¦‚è·¯å¾„åƒè¿™æ ·ï¼š<br><a href="http://localhost:6080/arcgis/manager/index.html" target="_blank" rel="noopener">http://localhost:6080/arcgis/manager/index.html</a></p><p>æˆ‘ä»¬éœ€è¦é…ç½®â€ç«™ç‚¹â€é€‰é¡¹å¡ä¸‹çš„å‡ ä¸ªä¸œè¥¿ï¼š</p><h3 id="ç¼“å­˜ç›®å½•"><a href="#ç¼“å­˜ç›®å½•" class="headerlink" title="ç¼“å­˜ç›®å½•"></a>ç¼“å­˜ç›®å½•</h3><p>åœ¨â€ç›®å½•â€ä¸‹ï¼Œä¿®æ”¹ç¼“å­˜ç›®å½•çš„ä½ç½®åˆ°ä¸€ä¸ªå‰©ä½™ç£ç›˜ç©ºé—´æ¯”è¾ƒå¤§çš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å¤šä¸ªç¼“å­˜ç›®å½•ï¼Œåœ¨åé¢çš„æ­¥éª¤é‡Œä¸ºä¸åŒçš„å›¾å±‚æŒ‡å®šä¸åŒçš„ç¼“å­˜ç›®å½•ã€‚<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-4" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><h3 id="Data-Storeé‡Œæ³¨å†Œæ–‡ä»¶å¤¹"><a href="#Data-Storeé‡Œæ³¨å†Œæ–‡ä»¶å¤¹" class="headerlink" title="Data Storeé‡Œæ³¨å†Œæ–‡ä»¶å¤¹"></a>Data Storeé‡Œæ³¨å†Œæ–‡ä»¶å¤¹</h3><p>åšè¿™æ­¥æ“ä½œçš„åŸå› æ˜¯ï¼Œå³ä½¿ä½ åœ¨æœ¬æœºä¸Šåˆ¶ä½œmxd/sdæ–‡æ¡£å¹¶å‘å¸ƒåˆ°æœ¬æœºçš„arcgis serverï¼Œarcserverä»ç„¶ä¼šæŠŠmxdç”¨åˆ°çš„æ•°æ®æ–‡ä»¶ä¸Šä¼ åˆ°arcserverçš„ç›®å½•ä¸‹ï¼Œè¿™å°±å¾ˆè›‹ç–¼äº†ã€‚ã€‚<br>äºæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•°æ®æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹æ³¨å†Œè¿›æ¥ï¼Œè¿™æ ·mxdç”¨åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶æ—¶å°±ä¸éœ€è¦ä¸Šä¼ äº†ã€‚<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-5" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><h2 id="å‘å¸ƒåœ°å›¾æ–‡æ¡£"><a href="#å‘å¸ƒåœ°å›¾æ–‡æ¡£" class="headerlink" title="å‘å¸ƒåœ°å›¾æ–‡æ¡£"></a>å‘å¸ƒåœ°å›¾æ–‡æ¡£</h2><p>å¥½äº†ï¼Œç°åœ¨å¯ä»¥å¼€å§‹å‘å¸ƒåˆšæ‰åˆ¶ä½œå¥½çš„mxdäº†ï¼Œåœ¨ArcMapä¸­ï¼Œç‚¹å‡»â€æ–‡ä»¶â€-&gt;â€å…±äº«ä¸ºâ€-&gt;â€æœåŠ¡â€ï¼Œçœ‹åˆ°å¦‚ä¸‹ç•Œé¢:<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-6" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><p>é€‰æ‹©â€å‘å¸ƒæœåŠ¡â€çš„è¯ï¼Œå°±èƒ½ç›´æ¥æŠŠmxdå‘æˆå›¾å±‚ï¼Œâ€ä¿å­˜æœåŠ¡å®šä¹‰æ–‡ä»¶â€åˆ™ä¼šç”Ÿæˆä¸€ä¸ªsdæ–‡æ¡£ã€‚è¿‡ç¨‹å¤§åŒå°å¼‚ï¼Œä¸€è·¯ä¸‹ä¸€æ­¥ï¼Œè®¾ç½®ä¸€äº›å¸¸è§„ä¿¡æ¯ï¼Œæ¥åˆ°è¿™ä¸€æ­¥ï¼š<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-7" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><p>ç‰¹åˆ«è¯´ä¸€ä¸‹ç¼“å­˜è¿™é‡Œ</p><h3 id="ç¼“å­˜é…ç½®"><a href="#ç¼“å­˜é…ç½®" class="headerlink" title="ç¼“å­˜é…ç½®"></a>ç¼“å­˜é…ç½®</h3><p>ä¹Ÿå°±æ˜¯ç“¦ç‰‡åœ°å›¾åˆ‡ç‰‡ã€‚<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-8" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p><p>ç¼“å­˜çš„é«˜çº§è®¾ç½®ä¸‹é¢ï¼Œå¯ä»¥é€‰æ‹©åˆ‡ç‰‡çš„ç¼“å­˜ç›®å½•ï¼Œèƒ½é€‰æ‹©çš„ç›®å½•å°±æ˜¯å‰æ–‡ä¸­arcgis serveré‡Œé…ç½®è¿‡çš„ã€‚<br>é«˜çº§è®¾ç½®çš„é«˜çº§æŒ‰é’®(è°èµ·çš„åå­—-_-)é‡Œï¼Œå¯ä»¥è®¾ç½®åˆ‡ç‰‡çš„å­˜å‚¨æ˜¯æ¾æ•£å‹è¿˜æ˜¯ç´§å‡‘å‹ï¼Œæ¾æ•£å‹åˆ‡å‡ºæ¥å°±æ˜¯ä¸€å¼ å¼ å›¾ç‰‡ï¼Œçº§åˆ«è¾ƒé«˜æ—¶å›¾ç‰‡æ•°é‡ä¼šéå¸¸å¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘ä»¬ä¸å¤ªå»ç”¨è¿™ç§æ ¼å¼ï¼›ç´§å‡‘å‹æ ¼å¼çš„è§£æå¯ä»¥å‚è€ƒ<a href="http://www.cnblogs.com/ssai2015/p/4926323.html" target="_blank" rel="noopener">è¿™ä¸ªå¸–å­</a>ï¼Œéœ€è¦æ³¨æ„çš„7æ˜¯ï¼Œä½ç‰ˆæœ¬çš„arcserveråˆ‡å‡ºæ¥çš„bundleã€bundlexæ–‡ä»¶æ˜¯åˆ†å¼€çš„ã€‚</p><p>å¥½å•¦ï¼Œé…ç½®å®Œæˆï¼Œç‚¹ä¸€ä¸‹åˆ†ææŒ‰é’®ï¼Œæ²¡æœ‰é”™è¯¯çš„è¯ç‚¹å‡»å‘å¸ƒï¼Œç¨ç­‰ç‰‡åˆ»å°±æ–‡æ¡£å°±å‘å¸ƒåˆ°arcserverä¸Šäº†ã€‚å¦‚æœé…ç½®äº†åˆ‡ç‰‡ï¼Œåˆ‡ç‰‡ä»»åŠ¡ä¼šåœ¨arcserverçš„åå°æ‰§è¡Œï¼Œæ‰€ä»¥å…³æ‰arcmapã€catalogä¹Ÿæ²¡é—®é¢˜ã€‚éšåï¼Œå¯ä»¥åœ¨catalogé‡Œå³é”®æ­¤å›¾å±‚-&gt;æŸ¥çœ‹ç¼“å­˜çŠ¶æ€-&gt;è¯¦ç»†ä¿¡æ¯ æ¥æŸ¥çœ‹åˆ‡ç‰‡è¿›åº¦ã€‚<br><img src="http://7xlvcv.com1.z0.glb.clouddn.com/2017-09-5-arcgis-publishing-layer-9" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p>]]></content>
    
    
    <categories>
      
      <category>gis</category>
      
      <category>å·¥å…·å’Œè½¯ä»¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>arcgis</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
